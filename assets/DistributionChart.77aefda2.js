import{C as Ft}from"./ChartPlaceholder.3d69ad26.js";import{e as m,c as nt,d as At,f as Ot,m as Ut,g as Tt,k as Ct,h as Wt,j as Dt,l as X,n as ct,o as dt,p as rt,s as it,q as Y,r as qt,t as Kt,v as ot,x as Zt,y as Gt,z as St,A as wt,B as Jt,C as Qt,D as te,E as ee,F as ae,S as Mt,G as vt,H as ne,I as re,P as ie,J as st,L as oe,K as Et,M as bt,R as zt,N as se,O as ue,Q as le,T as ce,U as de,V as kt,W as fe,X as ge,Y as he,Z as pe,u as ve,_ as ye,b as me}from"./installSVGRenderer.8b3eef45.js";import{d as Pt,k as N,c as ft,n as $t,a as H,o as gt,_ as Rt,u as xe,g as Ie,P as Le}from"./index.295b5789.js";import{b as w,t as U}from"./budgets.8c854936.js";import"./Icon.b3a1e9da.js";import"./useResizeObserver.5fc46550.js";var V=Ut();function Ve(a){var t=a.mainData,e=a.datas;e||(e={main:t},a.datasAttr={main:"data"}),a.datas=a.mainData=null,Bt(t,e,a),m(e,function(n){m(t.TRANSFERABLE_METHODS,function(r){n.wrapMethod(r,nt(De,a))})}),t.wrapMethod("cloneShallow",nt(we,a)),m(t.CHANGABLE_METHODS,function(n){t.wrapMethod(n,nt(Se,a))}),At(e[t.dataType]===t)}function De(a,t){if(be(this)){var e=Ot({},V(this).datas);e[this.dataType]=t,Bt(t,e,a)}else yt(t,this.dataType,V(this).mainData,a);return t}function Se(a,t){return a.struct&&a.struct.update(),t}function we(a,t){return m(V(t).datas,function(e,n){e!==t&&yt(e.cloneShallow(),n,t,a)}),t}function Me(a){var t=V(this).mainData;return a==null||t==null?t:V(t).datas[a]}function Ee(){var a=V(this).mainData;return a==null?[{data:a}]:Tt(Ct(V(a).datas),function(t){return{type:t,data:V(a).datas[t]}})}function be(a){return V(a).mainData===a}function Bt(a,t,e){V(a).datas={},m(t,function(n,r){yt(n,r,a,e)})}function yt(a,t,e,n){V(e).datas[t]=a,V(a).mainData=e,a.dataType=t,n.struct&&(a[n.structAttr]=n.struct,n.struct[n.datasAttr[t]]=a),a.getLinkedData=Me,a.getLinkedDataAll=Ee}var j=m,ke=X,K=-1,mt=function(){function a(t){var e=t.mappingMethod,n=t.type,r=this.option=Wt(t);this.type=n,this.mappingMethod=e,this._normalizeData=Te[e];var i=a.visualHandlers[n];this.applyVisual=i.applyVisual,this.getColorMapper=i.getColorMapper,this._normalizedToVisual=i._normalizedToVisual[e],e==="piecewise"?(ut(r),_e(r)):e==="category"?r.categories?Ae(r):ut(r,!0):(At(e!=="linear"||r.dataExtent),ut(r))}return a.prototype.mapValueToVisual=function(t){var e=this._normalizeData(t);return this._normalizedToVisual(e,t)},a.prototype.getNormalizer=function(){return Dt(this._normalizeData,this)},a.listVisualTypes=function(){return Ct(a.visualHandlers)},a.isValidType=function(t){return a.visualHandlers.hasOwnProperty(t)},a.eachVisual=function(t,e,n){X(t)?m(t,e,n):e.call(n,t)},a.mapVisual=function(t,e,n){var r,i=ct(t)?[]:X(t)?{}:(r=!0,null);return a.eachVisual(t,function(o,s){var u=e.call(n,o,s);r?i=u:i[s]=u}),i},a.retrieveVisuals=function(t){var e={},n;return t&&j(a.visualHandlers,function(r,i){t.hasOwnProperty(i)&&(e[i]=t[i],n=!0)}),n?e:null},a.prepareVisualTypes=function(t){if(ct(t))t=t.slice();else if(ke(t)){var e=[];j(t,function(n,r){e.push(r)}),t=e}else return[];return t.sort(function(n,r){return r==="color"&&n!=="color"&&n.indexOf("color")===0?1:-1}),t},a.dependsOn=function(t,e){return e==="color"?!!(t&&t.indexOf(e)===0):t===e},a.findPieceIndex=function(t,e,n){for(var r,i=1/0,o=0,s=e.length;o<s;o++){var u=e[o].value;if(u!=null){if(u===t||dt(u)&&u===t+"")return o;n&&v(u,o)}}for(var o=0,s=e.length;o<s;o++){var d=e[o],c=d.interval,g=d.close;if(c){if(c[0]===-1/0){if(q(g[1],t,c[1]))return o}else if(c[1]===1/0){if(q(g[0],c[0],t))return o}else if(q(g[0],c[0],t)&&q(g[1],t,c[1]))return o;n&&v(c[0],o),n&&v(c[1],o)}}if(n)return t===1/0?e.length-1:t===-1/0?0:r;function v(p,l){var f=Math.abs(p-t);f<i&&(i=f,r=l)}},a.visualHandlers={color:{applyVisual:R("color"),getColorMapper:function(){var t=this.option;return Dt(t.mappingMethod==="category"?function(e,n){return!n&&(e=this._normalizeData(e)),B.call(this,e)}:function(e,n,r){var i=!!r;return!n&&(e=this._normalizeData(e)),r=rt(e,t.parsedVisual,r),i?r:it(r,"rgba")},this)},_normalizedToVisual:{linear:function(t){return it(rt(t,this.option.parsedVisual),"rgba")},category:B,piecewise:function(t,e){var n=pt.call(this,e);return n==null&&(n=it(rt(t,this.option.parsedVisual),"rgba")),n},fixed:b}},colorHue:W(function(t,e){return ot(t,e)}),colorSaturation:W(function(t,e){return ot(t,null,e)}),colorLightness:W(function(t,e){return ot(t,null,null,e)}),colorAlpha:W(function(t,e){return Zt(t,e)}),decal:{applyVisual:R("decal"),_normalizedToVisual:{linear:null,category:B,piecewise:null,fixed:null}},opacity:{applyVisual:R("opacity"),_normalizedToVisual:ht([0,1])},liftZ:{applyVisual:R("liftZ"),_normalizedToVisual:{linear:b,category:b,piecewise:b,fixed:b}},symbol:{applyVisual:function(t,e,n){var r=this.mapValueToVisual(t);n("symbol",r)},_normalizedToVisual:{linear:_t,category:B,piecewise:function(t,e){var n=pt.call(this,e);return n==null&&(n=_t.call(this,t)),n},fixed:b}},symbolSize:{applyVisual:R("symbolSize"),_normalizedToVisual:ht([0,1])}},a}();function _e(a){var t=a.pieceList;a.hasSpecialVisual=!1,m(t,function(e,n){e.originIndex=n,e.visual!=null&&(a.hasSpecialVisual=!0)})}function Ae(a){var t=a.categories,e=a.categoryMap={},n=a.visual;if(j(t,function(o,s){e[o]=s}),!ct(n)){var r=[];X(n)?j(n,function(o,s){var u=e[s];r[u!=null?u:K]=o}):r[K]=n,n=Nt(a,r)}for(var i=t.length-1;i>=0;i--)n[i]==null&&(delete e[t[i]],t.pop())}function ut(a,t){var e=a.visual,n=[];X(e)?j(e,function(i){n.push(i)}):e!=null&&n.push(e);var r={color:1,symbol:1};!t&&n.length===1&&!r.hasOwnProperty(a.type)&&(n[1]=n[0]),Nt(a,n)}function W(a){return{applyVisual:function(t,e,n){var r=this.mapValueToVisual(t);n("color",a(e("color"),r))},_normalizedToVisual:ht([0,1])}}function _t(a){var t=this.option.visual;return t[Math.round(Y(a,[0,1],[0,t.length-1],!0))]||{}}function R(a){return function(t,e,n){n(a,this.mapValueToVisual(t))}}function B(a){var t=this.option.visual;return t[this.option.loop&&a!==K?a%t.length:a]}function b(){return this.option.visual[0]}function ht(a){return{linear:function(t){return Y(t,a,this.option.visual,!0)},category:B,piecewise:function(t,e){var n=pt.call(this,e);return n==null&&(n=Y(t,a,this.option.visual,!0)),n},fixed:b}}function pt(a){var t=this.option,e=t.pieceList;if(t.hasSpecialVisual){var n=mt.findPieceIndex(a,e),r=e[n];if(r&&r.visual)return r.visual[this.type]}}function Nt(a,t){return a.visual=t,a.type==="color"&&(a.parsedVisual=Tt(t,function(e){var n=qt(e);return n||[0,0,0,1]})),t}var Te={linear:function(a){return Y(a,this.option.dataExtent,[0,1],!0)},piecewise:function(a){var t=this.option.pieceList,e=mt.findPieceIndex(a,t,!0);if(e!=null)return Y(e,[0,t.length-1],[0,1],!0)},category:function(a){var t=this.option.categories?this.option.categoryMap[a]:a;return t==null?K:t},fixed:Kt};function q(a,t,e){return a?t<=e:t<e}const Ce=mt;function P(a){return"_EC_"+a}var Ge=function(){function a(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return a.prototype.isDirected=function(){return this._directed},a.prototype.addNode=function(t,e){t=t==null?""+e:""+t;var n=this._nodesMap;if(!n[P(t)]){var r=new k(t,e);return r.hostGraph=this,this.nodes.push(r),n[P(t)]=r,r}},a.prototype.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},a.prototype.getNodeById=function(t){return this._nodesMap[P(t)]},a.prototype.addEdge=function(t,e,n){var r=this._nodesMap,i=this._edgesMap;if(St(t)&&(t=this.nodes[t]),St(e)&&(e=this.nodes[e]),t instanceof k||(t=r[P(t)]),e instanceof k||(e=r[P(e)]),!(!t||!e)){var o=t.id+"-"+e.id,s=new Ht(t,e,n);return s.hostGraph=this,this._directed&&(t.outEdges.push(s),e.inEdges.push(s)),t.edges.push(s),t!==e&&e.edges.push(s),this.edges.push(s),i[o]=s,s}},a.prototype.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},a.prototype.getEdge=function(t,e){t instanceof k&&(t=t.id),e instanceof k&&(e=e.id);var n=this._edgesMap;return this._directed?n[t+"-"+e]:n[t+"-"+e]||n[e+"-"+t]},a.prototype.eachNode=function(t,e){for(var n=this.nodes,r=n.length,i=0;i<r;i++)n[i].dataIndex>=0&&t.call(e,n[i],i)},a.prototype.eachEdge=function(t,e){for(var n=this.edges,r=n.length,i=0;i<r;i++)n[i].dataIndex>=0&&n[i].node1.dataIndex>=0&&n[i].node2.dataIndex>=0&&t.call(e,n[i],i)},a.prototype.breadthFirstTraverse=function(t,e,n,r){if(e instanceof k||(e=this._nodesMap[P(e)]),!!e){for(var i=n==="out"?"outEdges":n==="in"?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!t.call(r,e,null))for(var s=[e];s.length;)for(var u=s.shift(),d=u[i],o=0;o<d.length;o++){var c=d[o],g=c.node1===u?c.node2:c.node1;if(!g.__visited){if(t.call(r,g,u))return;s.push(g),g.__visited=!0}}}},a.prototype.update=function(){for(var t=this.data,e=this.edgeData,n=this.nodes,r=this.edges,i=0,o=n.length;i<o;i++)n[i].dataIndex=-1;for(var i=0,o=t.count();i<o;i++)n[t.getRawIndex(i)].dataIndex=i;e.filterSelf(function(s){var u=r[e.getRawIndex(s)];return u.node1.dataIndex>=0&&u.node2.dataIndex>=0});for(var i=0,o=r.length;i<o;i++)r[i].dataIndex=-1;for(var i=0,o=e.count();i<o;i++)r[e.getRawIndex(i)].dataIndex=i},a.prototype.clone=function(){for(var t=new a(this._directed),e=this.nodes,n=this.edges,r=0;r<e.length;r++)t.addNode(e[r].id,e[r].dataIndex);for(var r=0;r<n.length;r++){var i=n[r];t.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return t},a}(),k=function(){function a(t,e){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=t==null?"":t,this.dataIndex=e==null?-1:e}return a.prototype.degree=function(){return this.edges.length},a.prototype.inDegree=function(){return this.inEdges.length},a.prototype.outDegree=function(){return this.outEdges.length},a.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,n=e.data.getItemModel(this.dataIndex);return n.getModel(t)}},a.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},e=0;e<this.edges.length;e++){var n=this.edges[e];n.dataIndex<0||(t.edge.push(n.dataIndex),t.node.push(n.node1.dataIndex,n.node2.dataIndex))}return t},a}(),Ht=function(){function a(t,e,n){this.dataIndex=-1,this.node1=t,this.node2=e,this.dataIndex=n==null?-1:n}return a.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,n=e.edgeData.getItemModel(this.dataIndex);return n.getModel(t)}},a.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},a}();function Xt(a,t){return{getValue:function(e){var n=this[a][t];return n.getStore().get(n.getDimensionIndex(e||"value"),this.dataIndex)},setVisual:function(e,n){this.dataIndex>=0&&this[a][t].setItemVisual(this.dataIndex,e,n)},getVisual:function(e){return this[a][t].getItemVisual(this.dataIndex,e)},setLayout:function(e,n){this.dataIndex>=0&&this[a][t].setItemLayout(this.dataIndex,e,n)},getLayout:function(){return this[a][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[a][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[a][t].getRawIndex(this.dataIndex)}}}Gt(k,Xt("hostGraph","data"));Gt(Ht,Xt("hostGraph","edgeData"));const ze=Ge;function Pe(a,t,e,n,r){for(var i=new ze(n),o=0;o<a.length;o++)i.addNode(wt(a[o].id,a[o].name,o),o);for(var s=[],u=[],d=0,o=0;o<t.length;o++){var c=t[o],g=c.source,v=c.target;i.addEdge(g,v,d)&&(u.push(c),s.push(wt(Jt(c.id,null),g+" > "+v)),d++)}var p=e.get("coordinateSystem"),l;if(p==="cartesian2d"||p==="polar")l=Qt(a,e);else{var f=te.get(p),h=f?f.dimensions||[]:[];ee(h,"value")<0&&h.concat(["value"]);var x=ae(a,{coordDimensions:h,encodeDefine:e.getEncode()}).dimensions;l=new Mt(x,e),l.initData(a)}var y=new Mt(["value"],e);return y.initData(u,s),r&&r(l,y),Ve({mainData:l,struct:i,structAttr:"graph",datas:{node:l,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),i.update(),i}var $e=function(){function a(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}return a}(),Re=function(a){vt(t,a);function t(e){return a.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new $e},t.prototype.buildPath=function(e,n){var r=n.extent;e.moveTo(n.x1,n.y1),e.bezierCurveTo(n.cpx1,n.cpy1,n.cpx2,n.cpy2,n.x2,n.y2),n.orient==="vertical"?(e.lineTo(n.x2+r,n.y2),e.bezierCurveTo(n.cpx2+r,n.cpy2,n.cpx1+r,n.cpy1,n.x1+r,n.y1)):(e.lineTo(n.x2,n.y2+r),e.bezierCurveTo(n.cpx2,n.cpy2+r,n.cpx1,n.cpy1+r,n.x1,n.y1+r)),e.closePath()},t.prototype.highlight=function(){ne(this)},t.prototype.downplay=function(){re(this)},t}(ie),Be=function(a){vt(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e._focusAdjacencyDisabled=!1,e}return t.prototype.render=function(e,n,r){var i=this,o=e.getGraph(),s=this.group,u=e.layoutInfo,d=u.width,c=u.height,g=e.getData(),v=e.getData("edge"),p=e.get("orient");this._model=e,s.removeAll(),s.x=u.x,s.y=u.y,o.eachEdge(function(l){var f=new Re,h=st(f);h.dataIndex=l.dataIndex,h.seriesIndex=e.seriesIndex,h.dataType="edge";var x=l.getModel(),y=x.getModel("lineStyle"),I=y.get("curveness"),L=l.node1.getLayout(),D=l.node1.getModel(),_=D.get("localX"),S=D.get("localY"),A=l.node2.getLayout(),xt=l.node2.getModel(),F=xt.get("localX"),O=xt.get("localY"),$=l.getLayout(),T,C,G,z,J,Q,tt,et;switch(f.shape.extent=Math.max(1,$.dy),f.shape.orient=p,p==="vertical"?(T=(_!=null?_*d:L.x)+$.sy,C=(S!=null?S*c:L.y)+L.dy,G=(F!=null?F*d:A.x)+$.ty,z=O!=null?O*c:A.y,J=T,Q=C*(1-I)+z*I,tt=G,et=C*I+z*(1-I)):(T=(_!=null?_*d:L.x)+L.dx,C=(S!=null?S*c:L.y)+$.sy,G=F!=null?F*d:A.x,z=(O!=null?O*c:A.y)+$.ty,J=T*(1-I)+G*I,Q=C,tt=T*I+G*(1-I),et=z),f.setShape({x1:T,y1:C,x2:G,y2:z,cpx1:J,cpy1:Q,cpx2:tt,cpy2:et}),f.useStyle(y.getItemStyle()),f.style.fill){case"source":f.style.fill=l.node1.getVisual("color"),f.style.decal=l.node1.getVisual("style").decal;break;case"target":f.style.fill=l.node2.getVisual("color"),f.style.decal=l.node2.getVisual("style").decal;break;case"gradient":var It=l.node1.getVisual("color"),Lt=l.node2.getVisual("color");dt(It)&&dt(Lt)&&(f.style.fill=new oe(0,0,+(p==="horizontal"),+(p==="vertical"),[{color:It,offset:0},{color:Lt,offset:1}]))}var at=x.getModel("emphasis");Et(f,x,"lineStyle",function(jt){return jt.getItemStyle()}),s.add(f),v.setItemGraphicEl(l.dataIndex,f);var Vt=at.get("focus");bt(f,Vt==="adjacency"?l.getAdjacentDataIndices():Vt,at.get("blurScope"),at.get("disabled")),st(f).dataType="edge"}),o.eachNode(function(l){var f=l.getLayout(),h=l.getModel(),x=h.get("localX"),y=h.get("localY"),I=h.getModel("emphasis"),L=new zt({shape:{x:x!=null?x*d:f.x,y:y!=null?y*c:f.y,width:f.dx,height:f.dy},style:h.getModel("itemStyle").getItemStyle(),z2:10});se(L,ue(h),{labelFetcher:e,labelDataIndex:l.dataIndex,defaultText:l.id}),L.disableLabelAnimation=!0,L.setStyle("fill",l.getVisual("color")),L.setStyle("decal",l.getVisual("style").decal),Et(L,h),s.add(L),g.setItemGraphicEl(l.dataIndex,L),st(L).dataType="node";var D=I.get("focus");bt(L,D==="adjacency"?l.getAdjacentDataIndices():D,I.get("blurScope"),I.get("disabled"))}),g.eachItemGraphicEl(function(l,f){var h=g.getItemModel(f);h.get("draggable")&&(l.drift=function(x,y){i._focusAdjacencyDisabled=!0,this.shape.x+=x,this.shape.y+=y,this.dirty(),r.dispatchAction({type:"dragNode",seriesId:e.id,dataIndex:g.getRawIndex(f),localX:this.shape.x/d,localY:this.shape.y/c})},l.ondragend=function(){i._focusAdjacencyDisabled=!1},l.draggable=!0,l.cursor="move")}),!this._data&&e.isAnimationEnabled()&&s.setClipPath(Ne(s.getBoundingRect(),e,function(){s.removeClipPath()})),this._data=e.getData()},t.prototype.dispose=function(){},t.type="sankey",t}(le);function Ne(a,t,e){var n=new zt({shape:{x:a.x-10,y:a.y-10,width:0,height:a.height+20}});return ce(n,{shape:{width:a.width+20}},t,e),n}const He=Be;var Xe=function(a){vt(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.getInitialData=function(e,n){var r=e.edges||e.links,i=e.data||e.nodes,o=e.levels;this.levelModels=[];for(var s=this.levelModels,u=0;u<o.length;u++)o[u].depth!=null&&o[u].depth>=0&&(s[o[u].depth]=new de(o[u],this,n));if(i&&r){var d=Pe(i,r,this,!0,c);return d.data}function c(g,v){g.wrapMethod("getItemModel",function(p,l){var f=p.parentModel,h=f.getData().getItemLayout(l);if(h){var x=h.depth,y=f.levelModels[x];y&&(p.parentModel=y)}return p}),v.wrapMethod("getItemModel",function(p,l){var f=p.parentModel,h=f.getGraph().getEdgeByIndex(l),x=h.node1.getLayout();if(x){var y=x.depth,I=f.levelModels[y];I&&(p.parentModel=I)}return p})}},t.prototype.setNodePosition=function(e,n){var r=this.option.data||this.option.nodes,i=r[e];i.localX=n[0],i.localY=n[1]},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(e,n,r){function i(p){return isNaN(p)||p==null}if(r==="edge"){var o=this.getDataParams(e,r),s=o.data,u=o.value,d=s.source+" -- "+s.target;return kt("nameValue",{name:d,value:u,noValue:i(u)})}else{var c=this.getGraph().getNodeByIndex(e),g=c.getLayout().value,v=this.getDataParams(e,r).data.name;return kt("nameValue",{name:v!=null?v+"":null,value:g,noValue:i(g)})}},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(e,n){var r=a.prototype.getDataParams.call(this,e,n);if(r.value==null&&n==="node"){var i=this.getGraph().getNodeByIndex(e),o=i.getLayout().value;r.value=o}return r},t.type="series.sankey",t.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},t}(fe);const Ye=Xe;function je(a,t){a.eachSeriesByType("sankey",function(e){var n=e.get("nodeWidth"),r=e.get("nodeGap"),i=Fe(e,t);e.layoutInfo=i;var o=i.width,s=i.height,u=e.getGraph(),d=u.nodes,c=u.edges;Ue(d);var g=ge(d,function(f){return f.getLayout().value===0}),v=g.length!==0?0:e.get("layoutIterations"),p=e.get("orient"),l=e.get("nodeAlign");Oe(d,c,n,r,o,s,v,p,l)})}function Fe(a,t){return he(a.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Oe(a,t,e,n,r,i,o,s,u){We(a,t,e,r,i,s,u),Je(a,t,i,r,n,o,s),sa(a,s)}function Ue(a){m(a,function(t){var e=M(t.outEdges,Z),n=M(t.inEdges,Z),r=t.getValue()||0,i=Math.max(e,n,r);t.setLayout({value:i},!0)})}function We(a,t,e,n,r,i,o){for(var s=[],u=[],d=[],c=[],g=0,v=0;v<t.length;v++)s[v]=1;for(var v=0;v<a.length;v++)u[v]=a[v].inEdges.length,u[v]===0&&d.push(a[v]);for(var p=-1;d.length;){for(var l=0;l<d.length;l++){var f=d[l],h=f.hostGraph.data.getRawDataItem(f.dataIndex),x=h.depth!=null&&h.depth>=0;x&&h.depth>p&&(p=h.depth),f.setLayout({depth:x?h.depth:g},!0),i==="vertical"?f.setLayout({dy:e},!0):f.setLayout({dx:e},!0);for(var y=0;y<f.outEdges.length;y++){var I=f.outEdges[y],L=t.indexOf(I);s[L]=0;var D=I.node2,_=a.indexOf(D);--u[_]===0&&c.indexOf(D)<0&&c.push(D)}}++g,d=c,c=[]}for(var v=0;v<s.length;v++)if(s[v]===1)throw new Error("Sankey is a DAG, the original data has cycle!");var S=p>g-1?p:g-1;o&&o!=="left"&&qe(a,o,i,S);var A=i==="vertical"?(r-e)/S:(n-e)/S;Ze(a,A,i)}function Yt(a){var t=a.hostGraph.data.getRawDataItem(a.dataIndex);return t.depth!=null&&t.depth>=0}function qe(a,t,e,n){if(t==="right"){for(var r=[],i=a,o=0;i.length;){for(var s=0;s<i.length;s++){var u=i[s];u.setLayout({skNodeHeight:o},!0);for(var d=0;d<u.inEdges.length;d++){var c=u.inEdges[d];r.indexOf(c.node1)<0&&r.push(c.node1)}}i=r,r=[],++o}m(a,function(g){Yt(g)||g.setLayout({depth:Math.max(0,n-g.getLayout().skNodeHeight)},!0)})}else t==="justify"&&Ke(a,n)}function Ke(a,t){m(a,function(e){!Yt(e)&&!e.outEdges.length&&e.setLayout({depth:t},!0)})}function Ze(a,t,e){m(a,function(n){var r=n.getLayout().depth*t;e==="vertical"?n.setLayout({y:r},!0):n.setLayout({x:r},!0)})}function Je(a,t,e,n,r,i,o){var s=Qe(a,o);ta(s,t,e,n,r,o),lt(s,r,e,n,o);for(var u=1;i>0;i--)u*=.99,ea(s,u,o),lt(s,r,e,n,o),oa(s,u,o),lt(s,r,e,n,o)}function Qe(a,t){var e=[],n=t==="vertical"?"y":"x",r=pe(a,function(i){return i.getLayout()[n]});return r.keys.sort(function(i,o){return i-o}),m(r.keys,function(i){e.push(r.buckets.get(i))}),e}function ta(a,t,e,n,r,i){var o=1/0;m(a,function(s){var u=s.length,d=0;m(s,function(g){d+=g.getLayout().value});var c=i==="vertical"?(n-(u-1)*r)/d:(e-(u-1)*r)/d;c<o&&(o=c)}),m(a,function(s){m(s,function(u,d){var c=u.getLayout().value*o;i==="vertical"?(u.setLayout({x:d},!0),u.setLayout({dx:c},!0)):(u.setLayout({y:d},!0),u.setLayout({dy:c},!0))})}),m(t,function(s){var u=+s.getValue()*o;s.setLayout({dy:u},!0)})}function lt(a,t,e,n,r){var i=r==="vertical"?"x":"y";m(a,function(o){o.sort(function(f,h){return f.getLayout()[i]-h.getLayout()[i]});for(var s,u,d,c=0,g=o.length,v=r==="vertical"?"dx":"dy",p=0;p<g;p++)u=o[p],d=c-u.getLayout()[i],d>0&&(s=u.getLayout()[i]+d,r==="vertical"?u.setLayout({x:s},!0):u.setLayout({y:s},!0)),c=u.getLayout()[i]+u.getLayout()[v]+t;var l=r==="vertical"?n:e;if(d=c-t-l,d>0){s=u.getLayout()[i]-d,r==="vertical"?u.setLayout({x:s},!0):u.setLayout({y:s},!0),c=s;for(var p=g-2;p>=0;--p)u=o[p],d=u.getLayout()[i]+u.getLayout()[v]+t-c,d>0&&(s=u.getLayout()[i]-d,r==="vertical"?u.setLayout({x:s},!0):u.setLayout({y:s},!0)),c=u.getLayout()[i]}})}function ea(a,t,e){m(a.slice().reverse(),function(n){m(n,function(r){if(r.outEdges.length){var i=M(r.outEdges,aa,e)/M(r.outEdges,Z);if(isNaN(i)){var o=r.outEdges.length;i=o?M(r.outEdges,na,e)/o:0}if(e==="vertical"){var s=r.getLayout().x+(i-E(r,e))*t;r.setLayout({x:s},!0)}else{var u=r.getLayout().y+(i-E(r,e))*t;r.setLayout({y:u},!0)}}})})}function aa(a,t){return E(a.node2,t)*a.getValue()}function na(a,t){return E(a.node2,t)}function ra(a,t){return E(a.node1,t)*a.getValue()}function ia(a,t){return E(a.node1,t)}function E(a,t){return t==="vertical"?a.getLayout().x+a.getLayout().dx/2:a.getLayout().y+a.getLayout().dy/2}function Z(a){return a.getValue()}function M(a,t,e){for(var n=0,r=a.length,i=-1;++i<r;){var o=+t(a[i],e);isNaN(o)||(n+=o)}return n}function oa(a,t,e){m(a,function(n){m(n,function(r){if(r.inEdges.length){var i=M(r.inEdges,ra,e)/M(r.inEdges,Z);if(isNaN(i)){var o=r.inEdges.length;i=o?M(r.inEdges,ia,e)/o:0}if(e==="vertical"){var s=r.getLayout().x+(i-E(r,e))*t;r.setLayout({x:s},!0)}else{var u=r.getLayout().y+(i-E(r,e))*t;r.setLayout({y:u},!0)}}})})}function sa(a,t){var e=t==="vertical"?"x":"y";m(a,function(n){n.outEdges.sort(function(r,i){return r.node2.getLayout()[e]-i.node2.getLayout()[e]}),n.inEdges.sort(function(r,i){return r.node1.getLayout()[e]-i.node1.getLayout()[e]})}),m(a,function(n){var r=0,i=0;m(n.outEdges,function(o){o.setLayout({sy:r},!0),r+=o.getLayout().dy}),m(n.inEdges,function(o){o.setLayout({ty:i},!0),i+=o.getLayout().dy})})}function ua(a){a.eachSeriesByType("sankey",function(t){var e=t.getGraph(),n=e.nodes;if(n.length){var r=1/0,i=-1/0;m(n,function(o){var s=o.getLayout().value;s<r&&(r=s),s>i&&(i=s)}),m(n,function(o){var s=new Ce({type:"color",mappingMethod:"linear",dataExtent:[r,i],visual:t.get("color")}),u=s.mapValueToVisual(o.getLayout().value),d=o.getModel().get(["itemStyle","color"]);d!=null?(o.setVisual("color",d),o.setVisual("style",{fill:d})):(o.setVisual("color",u),o.setVisual("style",{fill:u}))})}})}function la(a){a.registerChartView(He),a.registerSeriesModel(Ye),a.registerLayout(je),a.registerVisual(ua),a.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(t,e){e.eachComponent({mainType:"series",subType:"sankey",query:t},function(n){n.setNodePosition(t.dataIndex,[t.localX,t.localY])})})}const ca=Pt({__name:"SankeyChart",props:{class:null,data:null},setup(a){const t=a;ve([la,me]);const e=N(()=>t.class),n=N(()=>({series:{type:"sankey",animation:!1,label:{formatter:"{b}",textBorderWidth:0,fontWeight:"var(--font-weight-l)",fontFamily:"var(--font-family)",color:"var(--chart-label)"},lineStyle:{color:"source",curveness:.5},nodeGap:10,nodeWidth:7,left:0,right:0,links:t.data.links,data:t.data.labels.map(r=>({name:r.name,id:r.id,itemStyle:{color:r.color},label:r.align==="left"?{align:"right",padding:[0,20,0,0]}:void 0}))}}));return(r,i)=>(gt(),ft(ye,{class:$t([r.$style.sankeyChart,H(e)]),options:H(n)},null,8,["class","options"]))}}),da="Y",fa={sankeyChart:da},ga={$style:fa},ha=Rt(ca,[["__cssModules",ga]]),pa=Pt({__name:"DistributionChart",props:{class:null},setup(a){const t=a,e=N(()=>t.class),{state:n}=Ie(),{n:r}=xe(),i=N(()=>{const s=w(U(n.income)),u=w(U(n.expenses));return!s||!u}),o=N(()=>{const s=l=>r(l,"currency"),u=w(U(n.income)),d=w(U(n.expenses)),c=[],g=[],v=l=>`hsl(${l}, var(--chart-generic-saturation), var(--chart-generic-lightness))`,p={id:Le(),name:`Income (${s(u)})`,color:v(120)};c.push(p);for(const l of n.income){const f=w(l.budgets.flatMap(h=>h.values));c.push({id:l.id,name:`${l.name} (${s(f)})`,color:v(60+60*(f/u))}),g.push({target:p.id,source:l.id,value:f});for(let h=0;h<l.budgets.length;h++){const x=l.budgets[h],y=w(x.values);y&&(c.push({id:x.id,name:`${x.name} (${s(y)})`,color:v(60+60*(y/u))}),g.push({target:l.id,source:x.id,value:y}))}}for(const l of n.expenses){const f=w(l.budgets.flatMap(h=>h.values));c.push({id:l.id,name:`${l.name} (${s(f)})`,color:v(60*(1-f/d))}),g.push({target:l.id,source:p.id,value:f});for(let h=0;h<l.budgets.length;h++){const x=l.budgets[h],y=w(x.values);y&&(c.push({id:x.id,name:`${x.name} (${s(y)})`,color:v(60*(1-y/d)),align:"left"}),g.push({target:x.id,source:l.id,value:y}))}}return{labels:c,links:g}});return(s,u)=>H(i)?(gt(),ft(Ft,{key:0})):(gt(),ft(ha,{key:1,class:$t([s.$style.distributionChart,H(e)]),data:H(o)},null,8,["class","data"]))}}),va="v",ya={distributionChart:va},ma={$style:ya},Ma=Rt(pa,[["__cssModules",ma]]);export{Ma as default};
