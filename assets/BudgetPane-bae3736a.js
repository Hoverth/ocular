import{u as J,i as Z,a as x,b as ee,_ as te}from"./installSVGRenderer-6cb887fd.js";import{d as I,k as C,o as m,c as K,n as a,a as s,v as D,u as P,I as se,e as f,K as W,L as q,_ as U,j as le,b as p,y as ne,f as v,D as oe,x as E,l as H,F as w,r as L,g as X,w as j}from"./index-83718076.js";import{t as ae}from"./budgets-531db56b.js";import{P as ue}from"./Pane-c3e08548.js";import{B as R}from"./Button-27c39e06.js";import{C as S}from"./Currency-ff6cdbe0.js";import{b as z,c as O}from"./array-1d6fe4d9.js";import{u as re}from"./useMonthNames-b9bff84a.js";const ce=I({__name:"MiniChart",props:{class:null,values:null},setup(c){const b=c;J([Z,x,ee]);const o=C(()=>b.class),d=C(()=>({xAxis:{type:"category",show:!1},yAxis:{show:!1,min:Math.min(...b.values)},grid:{top:"15%",left:0,bottom:"20%",right:0},series:[{data:b.values,type:"line",smooth:!0,showSymbol:!1,silent:!0}]}));return(y,$)=>(m(),K(te,{class:a(s(o)),options:s(d)},null,8,["class","options"]))}}),de=["type","value"],ie=I({__name:"CurrencyCell",props:{modelValue:null,max:{default:Number.MAX_SAFE_INTEGER}},emits:["update:modelValue"],setup(c,{emit:b}){const o=c,d=D(),y=D(!1),{n:$}=P(),h=C(()=>{const l=o.modelValue;return y.value||!l?l||"":$(o.modelValue,"currency")}),V=l=>{b("update:modelValue",Math.max(l,0))},G=l=>{l.key==="-"&&l.preventDefault()},B=()=>{y.value=!0,q(()=>{d.value.select()})},u=l=>{const t=Number(l.target.value);!Number.isNaN(t)&&V(t)};return se(()=>o.modelValue,(l,t)=>{(l??0)>o.max&&t!==void 0&&b("update:modelValue",t)}),(l,t)=>(m(),f("input",{ref_key:"input",ref:d,class:a(l.$style.currencyCell),type:y.value?"number":"text",value:s(h),onBlur:t[0]||(t[0]=g=>y.value=!1),onFocus:B,onInput:u,onKeydown:[G,t[1]||(t[1]=W((...g)=>{var A,T;return((A=d.value)==null?void 0:A.blur)&&((T=d.value)==null?void 0:T.blur(...g))},["enter"]))]},null,42,de))}}),pe="hb",me={currencyCell:pe},ye={$style:me},ge=U(ie,[["__cssModules",ye]]),ve=["value"],fe=I({__name:"TextCell",props:{modelValue:null,inline:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:b}){const o=c,d=D(),y=le(),$=D(!1),h=C(()=>[y.textInput,{[y.empty]:!o.modelValue,[y.inline]:o.inline}]),V=()=>{$.value=!0,q(()=>{d.value.select()})},G=B=>{b("update:modelValue",B.target.value)};return(B,u)=>(m(),f("span",{class:a(s(h))},[p("input",{ref_key:"input",ref:d,value:c.modelValue,class:a(B.$style.input),type:"text",onBlur:u[0]||(u[0]=l=>$.value=!1),onFocus:V,onInput:G,onKeydown:u[1]||(u[1]=W((...l)=>{var t,g;return((t=d.value)==null?void 0:t.blur)&&((g=d.value)==null?void 0:g.blur(...l))},["enter"]))},null,42,ve)],2))}}),$e="rb",be="sb",_e="tb",he="ub",Ce={textInput:$e,input:be,inline:_e,empty:he},Be={$style:Ce},Q=U(fe,[["__cssModules",Be]]),i=ne({source:void 0,target:void 0,type:void 0}),ke=I({__name:"Draggable",props:{text:null,id:null},emits:["drop"],setup(c,{emit:b}){const o=c,d=D(),y=D(),$=D(0),h=D(0),V=C(()=>o.id===i.target&&i.type),G=C(()=>V.value?i.type==="before"?"skip-up-line":"skip-down-line":"draggable"),B=C(()=>{var r;return i.target&&i.target&&i.source?(r=o.text)==null?void 0:r.call(o,i):void 0}),u=r=>{r.dataTransfer&&y.value&&(i.source=o.id,r.dataTransfer.effectAllowed="move",r.dataTransfer.setDragImage(y.value,1/0,1/0))},l=r=>{$.value=r.pageX,h.value=r.pageY},t=r=>{var _;const e=(_=d.value)==null?void 0:_.getBoundingClientRect();if(r.preventDefault(),e&&o.id!==i.source){const n=r.pageY<e.top+e.height/2?"before":"after";i.target=o.id,i.type=n}},g=r=>{r.pageX&&r.pageY&&i.target!==o.id&&(i.type=void 0,i.target=void 0)},A=()=>{i.type=void 0,i.target=void 0,i.source=void 0},T=r=>{i.target&&i.target&&i.source&&b("drop",i),r.preventDefault()};return(r,e)=>(m(),f("div",{ref_key:"draggable",ref:d,class:a(r.$style.draggable),draggable:"true",onDragend:A,onDragover:t,onDragleave:g,onDrop:T,onDrag:l,onDragstart:u},[v(R,{color:s(V)?"primary":"dimmed",icon:s(G),textual:""},null,8,["color","icon"]),s(i).source===o.id&&h.value&&$.value&&s(B)?(m(),f("div",{key:0,style:oe({top:`${h.value+5}px`,left:`${$.value+5}px`}),class:a(r.$style.content)},[p("span",{class:a(r.$style.text)},E(s(B)),3)],6)):H("",!0),p("div",{ref_key:"element",ref:y,class:a(r.$style.hidden)},"hidden",2)],34))}}),Me="ib",Ve="jb",we="kb",Ge="lb",De={draggable:Me,content:Ve,text:we,hidden:Ge},Ne={$style:De},Ie=U(ke,[["__cssModules",Ne]]),Ae=p("span",null,null,-1),Te=p("span",{style:{"grid-column":"3 / 16"}},null,-1),Se=I({__name:"BudgetGroup",props:{group:null},setup(c){const b=c,{moveBudget:o,getBudget:d,addBudget:y,setBudgetName:$,setBudgetGroupName:h,setBudget:V,removeBudget:G,isCurrentMonth:B}=X(),{t:u}=P(),l=D(!0),t=C(()=>{const e=new Array(12).fill(0);for(const{values:_}of b.group.budgets)for(let n=0;n<_.length;n++)e[n]+=_[n];return e}),g=C(()=>z(t.value)),A=C(()=>O(t.value)),T=e=>{const[_,n]=e.source?d(e.source)??[]:[],[k,N]=e.target?d(e.target)??[]:[];if(n&&_)if(N&&k){const M=_.id===k.id,F=M?n.name:`${_.name} » ${n.name}`,Y=M?N.name:`${k.name} » ${N.name}`;return e.type==="before"?u("budget.prepend",{from:F,to:Y}):u("budget.append",{from:F,to:Y})}else return u("budget.move",{from:n.name})},r=e=>{o(e.source,e.target,e.type==="after")};return(e,_)=>(m(),f(w,null,[v(R,{icon:l.value?"arrow-down-s-line":"arrow-right-s-line",color:"dimmed",textual:"",onClick:_[0]||(_[0]=n=>l.value=!l.value)},null,8,["icon"]),v(Q,{class:a([e.$style.top,e.$style.start]),"model-value":c.group.name,inline:"","onUpdate:modelValue":_[1]||(_[1]=n=>s(h)(c.group.id,n))},null,8,["class","model-value"]),(m(!0),f(w,null,L(s(t),(n,k)=>(m(),f("span",{key:k,class:a(e.$style.top)},[v(S,{value:n},null,8,["value"])],2))),128)),p("span",{class:a(e.$style.top)},[p("span",null,E(s(u)("budget.total")),1)],2),p("span",{class:a([e.$style.top,e.$style.end])},[p("span",null,E(s(u)("budget.average")),1)],2),l.value?(m(),f(w,{key:0},[(m(!0),f(w,null,L(c.group.budgets,(n,k)=>(m(),f(w,{key:n.id+k},[v(Ie,{text:T,id:n.id,onDrop:r},null,8,["id"]),v(R,{color:"dimmed",icon:"close-circle",textual:"",onClick:N=>s(G)(n.id)},null,8,["onClick"]),p("span",{class:a(e.$style.header)},[v(Q,{"model-value":n.name,"onUpdate:modelValue":N=>s($)(n.id,N)},null,8,["model-value","onUpdate:modelValue"])],2),(m(!0),f(w,null,L(n.values,(N,M)=>(m(),f("span",{class:a([e.$style.currencyCell,{[e.$style.even]:k%2,[e.$style.firstRow]:k===0,[e.$style.firstColumn]:M===0,[e.$style.currentMonth]:s(B)(M),[e.$style.tlc]:k===0&&M===0,[e.$style.trc]:k===0&&M===11,[e.$style.blc]:k===c.group.budgets.length-1&&M===0,[e.$style.brc]:k===c.group.budgets.length-1&&M===11}]),key:n.id+M},[v(ge,{"model-value":n.values[M],"onUpdate:modelValue":F=>s(V)(n.id,M,F)},null,8,["model-value","onUpdate:modelValue"])],2))),128)),v(S,{class:a(e.$style.meta),value:s(z)(n.values)},null,8,["class","value"]),v(S,{class:a(e.$style.meta),value:s(O)(n.values)},null,8,["class","value"])],64))),128)),Ae,v(R,{icon:"plus",class:a(e.$style.addBudgetBtn),textual:"",onClick:_[2]||(_[2]=n=>s(y)(c.group.id)),color:"success"},null,8,["class"]),Te,v(S,{class:a([e.$style.meta,e.$style.bold]),value:s(g)},null,8,["class","value"]),v(S,{class:a([e.$style.meta,e.$style.bold]),value:s(A)},null,8,["class","value"])],64)):H("",!0)],64))}}),Le="K_",Re="L_",Ue="M_",Ee="N_",Fe="O_",Ke="P_",Pe="Q_",Xe="R_",Ye="S_",je="T_",ze="U_",Oe="V_",Qe="W_",We="X_",qe="Y_",He={header:Le,meta:Re,bold:Ue,top:Ee,start:Fe,end:Ke,currencyCell:Pe,firstRow:Xe,firstColumn:Ye,currentMonth:je,even:ze,tlc:Oe,trc:Qe,blc:We,brc:qe},Je={$style:He},Ze=U(Se,[["__cssModules",Je]]),xe=p("span",null,null,-1),et=p("span",null,null,-1),tt=p("span",null,null,-1),st=p("span",null,null,-1),lt=p("span",null,null,-1),nt=p("span",null,null,-1),ot=p("span",null,null,-1),at=p("span",null,null,-1),ut=p("span",null,null,-1),rt=p("span",null,null,-1),ct=I({__name:"BudgetGroups",props:{type:null},setup(c){const b=c,{state:o,addBudgetGroup:d,removeBudgetGroup:y,isCurrentMonth:$}=X(),{t:h}=P(),V=C(()=>o[b.type]),G=re(),B=C(()=>{const u=new Array(12).fill(0);for(const{budgets:l}of V.value)for(const{values:t}of l)for(let g=0;g<t.length;g++)u[g]+=t[g];return u});return(u,l)=>(m(),f("div",{class:a(u.$style.budgetGroups)},[xe,et,tt,(m(!0),f(w,null,L(s(G),(t,g)=>(m(),f("span",{key:t,class:a([u.$style.month,{[u.$style.current]:s($)(g)}])},[p("span",null,E(t),1)],2))),128)),st,lt,nt,ot,p("span",{class:a(u.$style.sum)},E(s(h)("budget.totals")),3),(m(!0),f(w,null,L(s(B),(t,g)=>(m(),K(S,{value:t,key:g,class:a(u.$style.sum)},null,8,["value","class"]))),128)),at,ut,(m(!0),f(w,null,L(s(V),t=>(m(),f(w,{key:t.id},[v(R,{color:"dimmed",icon:"close-circle",textual:"",onClick:g=>s(y)(t.id)},null,8,["onClick"]),v(Ze,{group:t},null,8,["group"])],64))),128)),rt,v(R,{class:a(u.$style.addGroupBtn),icon:"plus",text:s(h)("budget.addGroup"),onClick:l[0]||(l[0]=t=>s(d)(c.type))},null,8,["class","text"])],2))}}),dt="f_",it="g_",pt="h_",mt="i_",yt="j_",gt={budgetGroups:dt,sum:it,month:pt,current:mt,addGroupBtn:yt},vt={$style:gt},ft=U(ct,[["__cssModules",vt]]),$t=I({__name:"BudgetPane",props:{title:null,type:null},setup(c){const b=c,{state:o}=X(),d=C(()=>ae(o[b.type])),y=C(()=>d.value.reduce(($,h)=>$+h,0));return($,h)=>(m(),K(ue,{amount:s(y),title:c.title},{header:j(()=>[v(ce,{class:a($.$style.miniChart),values:s(d)},null,8,["class","values"])]),default:j(()=>[v(ft,{type:c.type},null,8,["type"])]),_:1},8,["amount","title"]))}}),bt="r",_t={miniChart:bt},ht={$style:_t},Nt=U($t,[["__cssModules",ht]]);export{Nt as B};
