import{C as Yt}from"./ChartPlaceholder.8f47c9f8.js";import{m as Ot,e as m,c as rt,d as At,f as Ut,g as Tt,k as Ct,h as Wt,j as Dt,l as X,n as ct,o as dt,p as nt,s as it,q as j,r as ot,t as qt,v as Kt,x as Zt,y as Gt,z as St,A as wt,B as Jt,C as Qt,D as te,E as ee,F as ae,S as Mt,G as pt,H as re,I as ne,P as ie,J as st,L as oe,K as Et,M as bt,R as zt,N as se,O as ue,Q as le,T as ce,U as de,V as kt,W as fe,X as ge,Y as he,Z as ve,u as pe,_ as ye,b as me}from"./installSVGRenderer.31a202ae.js";import{_ as Pt,d as $t,c as N,o as ft,a as gt,n as Rt,b as H,e as xe,f as Ie,C as Le}from"./index.07eae5ce.js";import{b as w,t as U}from"./budgets.8c854936.js";import"./Icon.70b29023.js";import"./useResizeObserver.a972bef5.js";var V=Ot();function Ve(a){var t=a.mainData,e=a.datas;e||(e={main:t},a.datasAttr={main:"data"}),a.datas=a.mainData=null,Bt(t,e,a),m(e,function(r){m(t.TRANSFERABLE_METHODS,function(n){r.wrapMethod(n,rt(De,a))})}),t.wrapMethod("cloneShallow",rt(we,a)),m(t.CHANGABLE_METHODS,function(r){t.wrapMethod(r,rt(Se,a))}),At(e[t.dataType]===t)}function De(a,t){if(be(this)){var e=Ut({},V(this).datas);e[this.dataType]=t,Bt(t,e,a)}else yt(t,this.dataType,V(this).mainData,a);return t}function Se(a,t){return a.struct&&a.struct.update(),t}function we(a,t){return m(V(t).datas,function(e,r){e!==t&&yt(e.cloneShallow(),r,t,a)}),t}function Me(a){var t=V(this).mainData;return a==null||t==null?t:V(t).datas[a]}function Ee(){var a=V(this).mainData;return a==null?[{data:a}]:Tt(Ct(V(a).datas),function(t){return{type:t,data:V(a).datas[t]}})}function be(a){return V(a).mainData===a}function Bt(a,t,e){V(a).datas={},m(t,function(r,n){yt(r,n,a,e)})}function yt(a,t,e,r){V(e).datas[t]=a,V(a).mainData=e,a.dataType=t,r.struct&&(a[r.structAttr]=r.struct,r.struct[r.datasAttr[t]]=a),a.getLinkedData=Me,a.getLinkedDataAll=Ee}var F=m,ke=X,K=-1,mt=function(){function a(t){var e=t.mappingMethod,r=t.type,n=this.option=Wt(t);this.type=r,this.mappingMethod=e,this._normalizeData=Te[e];var i=a.visualHandlers[r];this.applyVisual=i.applyVisual,this.getColorMapper=i.getColorMapper,this._normalizedToVisual=i._normalizedToVisual[e],e==="piecewise"?(ut(n),_e(n)):e==="category"?n.categories?Ae(n):ut(n,!0):(At(e!=="linear"||n.dataExtent),ut(n))}return a.prototype.mapValueToVisual=function(t){var e=this._normalizeData(t);return this._normalizedToVisual(e,t)},a.prototype.getNormalizer=function(){return Dt(this._normalizeData,this)},a.listVisualTypes=function(){return Ct(a.visualHandlers)},a.isValidType=function(t){return a.visualHandlers.hasOwnProperty(t)},a.eachVisual=function(t,e,r){X(t)?m(t,e,r):e.call(r,t)},a.mapVisual=function(t,e,r){var n,i=ct(t)?[]:X(t)?{}:(n=!0,null);return a.eachVisual(t,function(o,s){var u=e.call(r,o,s);n?i=u:i[s]=u}),i},a.retrieveVisuals=function(t){var e={},r;return t&&F(a.visualHandlers,function(n,i){t.hasOwnProperty(i)&&(e[i]=t[i],r=!0)}),r?e:null},a.prepareVisualTypes=function(t){if(ct(t))t=t.slice();else if(ke(t)){var e=[];F(t,function(r,n){e.push(n)}),t=e}else return[];return t.sort(function(r,n){return n==="color"&&r!=="color"&&r.indexOf("color")===0?1:-1}),t},a.dependsOn=function(t,e){return e==="color"?!!(t&&t.indexOf(e)===0):t===e},a.findPieceIndex=function(t,e,r){for(var n,i=1/0,o=0,s=e.length;o<s;o++){var u=e[o].value;if(u!=null){if(u===t||dt(u)&&u===t+"")return o;r&&p(u,o)}}for(var o=0,s=e.length;o<s;o++){var d=e[o],c=d.interval,g=d.close;if(c){if(c[0]===-1/0){if(q(g[1],t,c[1]))return o}else if(c[1]===1/0){if(q(g[0],c[0],t))return o}else if(q(g[0],c[0],t)&&q(g[1],t,c[1]))return o;r&&p(c[0],o),r&&p(c[1],o)}}if(r)return t===1/0?e.length-1:t===-1/0?0:n;function p(v,l){var f=Math.abs(v-t);f<i&&(i=f,n=l)}},a.visualHandlers={color:{applyVisual:R("color"),getColorMapper:function(){var t=this.option;return Dt(t.mappingMethod==="category"?function(e,r){return!r&&(e=this._normalizeData(e)),B.call(this,e)}:function(e,r,n){var i=!!n;return!r&&(e=this._normalizeData(e)),n=nt(e,t.parsedVisual,n),i?n:it(n,"rgba")},this)},_normalizedToVisual:{linear:function(t){return it(nt(t,this.option.parsedVisual),"rgba")},category:B,piecewise:function(t,e){var r=vt.call(this,e);return r==null&&(r=it(nt(t,this.option.parsedVisual),"rgba")),r},fixed:b}},colorHue:W(function(t,e){return ot(t,e)}),colorSaturation:W(function(t,e){return ot(t,null,e)}),colorLightness:W(function(t,e){return ot(t,null,null,e)}),colorAlpha:W(function(t,e){return qt(t,e)}),decal:{applyVisual:R("decal"),_normalizedToVisual:{linear:null,category:B,piecewise:null,fixed:null}},opacity:{applyVisual:R("opacity"),_normalizedToVisual:ht([0,1])},liftZ:{applyVisual:R("liftZ"),_normalizedToVisual:{linear:b,category:b,piecewise:b,fixed:b}},symbol:{applyVisual:function(t,e,r){var n=this.mapValueToVisual(t);r("symbol",n)},_normalizedToVisual:{linear:_t,category:B,piecewise:function(t,e){var r=vt.call(this,e);return r==null&&(r=_t.call(this,t)),r},fixed:b}},symbolSize:{applyVisual:R("symbolSize"),_normalizedToVisual:ht([0,1])}},a}();function _e(a){var t=a.pieceList;a.hasSpecialVisual=!1,m(t,function(e,r){e.originIndex=r,e.visual!=null&&(a.hasSpecialVisual=!0)})}function Ae(a){var t=a.categories,e=a.categoryMap={},r=a.visual;if(F(t,function(o,s){e[o]=s}),!ct(r)){var n=[];X(r)?F(r,function(o,s){var u=e[s];n[u!=null?u:K]=o}):n[K]=r,r=Nt(a,n)}for(var i=t.length-1;i>=0;i--)r[i]==null&&(delete e[t[i]],t.pop())}function ut(a,t){var e=a.visual,r=[];X(e)?F(e,function(i){r.push(i)}):e!=null&&r.push(e);var n={color:1,symbol:1};!t&&r.length===1&&!n.hasOwnProperty(a.type)&&(r[1]=r[0]),Nt(a,r)}function W(a){return{applyVisual:function(t,e,r){var n=this.mapValueToVisual(t);r("color",a(e("color"),n))},_normalizedToVisual:ht([0,1])}}function _t(a){var t=this.option.visual;return t[Math.round(j(a,[0,1],[0,t.length-1],!0))]||{}}function R(a){return function(t,e,r){r(a,this.mapValueToVisual(t))}}function B(a){var t=this.option.visual;return t[this.option.loop&&a!==K?a%t.length:a]}function b(){return this.option.visual[0]}function ht(a){return{linear:function(t){return j(t,a,this.option.visual,!0)},category:B,piecewise:function(t,e){var r=vt.call(this,e);return r==null&&(r=j(t,a,this.option.visual,!0)),r},fixed:b}}function vt(a){var t=this.option,e=t.pieceList;if(t.hasSpecialVisual){var r=mt.findPieceIndex(a,e),n=e[r];if(n&&n.visual)return n.visual[this.type]}}function Nt(a,t){return a.visual=t,a.type==="color"&&(a.parsedVisual=Tt(t,function(e){var r=Kt(e);return r||[0,0,0,1]})),t}var Te={linear:function(a){return j(a,this.option.dataExtent,[0,1],!0)},piecewise:function(a){var t=this.option.pieceList,e=mt.findPieceIndex(a,t,!0);if(e!=null)return j(e,[0,t.length-1],[0,1],!0)},category:function(a){var t=this.option.categories?this.option.categoryMap[a]:a;return t==null?K:t},fixed:Zt};function q(a,t,e){return a?t<=e:t<e}var Ce=mt;function P(a){return"_EC_"+a}var Ge=function(){function a(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return a.prototype.isDirected=function(){return this._directed},a.prototype.addNode=function(t,e){t=t==null?""+e:""+t;var r=this._nodesMap;if(!r[P(t)]){var n=new k(t,e);return n.hostGraph=this,this.nodes.push(n),r[P(t)]=n,n}},a.prototype.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},a.prototype.getNodeById=function(t){return this._nodesMap[P(t)]},a.prototype.addEdge=function(t,e,r){var n=this._nodesMap,i=this._edgesMap;if(St(t)&&(t=this.nodes[t]),St(e)&&(e=this.nodes[e]),t instanceof k||(t=n[P(t)]),e instanceof k||(e=n[P(e)]),!(!t||!e)){var o=t.id+"-"+e.id,s=new Ht(t,e,r);return s.hostGraph=this,this._directed&&(t.outEdges.push(s),e.inEdges.push(s)),t.edges.push(s),t!==e&&e.edges.push(s),this.edges.push(s),i[o]=s,s}},a.prototype.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},a.prototype.getEdge=function(t,e){t instanceof k&&(t=t.id),e instanceof k&&(e=e.id);var r=this._edgesMap;return this._directed?r[t+"-"+e]:r[t+"-"+e]||r[e+"-"+t]},a.prototype.eachNode=function(t,e){for(var r=this.nodes,n=r.length,i=0;i<n;i++)r[i].dataIndex>=0&&t.call(e,r[i],i)},a.prototype.eachEdge=function(t,e){for(var r=this.edges,n=r.length,i=0;i<n;i++)r[i].dataIndex>=0&&r[i].node1.dataIndex>=0&&r[i].node2.dataIndex>=0&&t.call(e,r[i],i)},a.prototype.breadthFirstTraverse=function(t,e,r,n){if(e instanceof k||(e=this._nodesMap[P(e)]),!!e){for(var i=r==="out"?"outEdges":r==="in"?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!t.call(n,e,null))for(var s=[e];s.length;)for(var u=s.shift(),d=u[i],o=0;o<d.length;o++){var c=d[o],g=c.node1===u?c.node2:c.node1;if(!g.__visited){if(t.call(n,g,u))return;s.push(g),g.__visited=!0}}}},a.prototype.update=function(){for(var t=this.data,e=this.edgeData,r=this.nodes,n=this.edges,i=0,o=r.length;i<o;i++)r[i].dataIndex=-1;for(var i=0,o=t.count();i<o;i++)r[t.getRawIndex(i)].dataIndex=i;e.filterSelf(function(s){var u=n[e.getRawIndex(s)];return u.node1.dataIndex>=0&&u.node2.dataIndex>=0});for(var i=0,o=n.length;i<o;i++)n[i].dataIndex=-1;for(var i=0,o=e.count();i<o;i++)n[e.getRawIndex(i)].dataIndex=i},a.prototype.clone=function(){for(var t=new a(this._directed),e=this.nodes,r=this.edges,n=0;n<e.length;n++)t.addNode(e[n].id,e[n].dataIndex);for(var n=0;n<r.length;n++){var i=r[n];t.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return t},a}(),k=function(){function a(t,e){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=t==null?"":t,this.dataIndex=e==null?-1:e}return a.prototype.degree=function(){return this.edges.length},a.prototype.inDegree=function(){return this.inEdges.length},a.prototype.outDegree=function(){return this.outEdges.length},a.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,r=e.data.getItemModel(this.dataIndex);return r.getModel(t)}},a.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},e=0;e<this.edges.length;e++){var r=this.edges[e];r.dataIndex<0||(t.edge.push(r.dataIndex),t.node.push(r.node1.dataIndex,r.node2.dataIndex))}return t},a}(),Ht=function(){function a(t,e,r){this.dataIndex=-1,this.node1=t,this.node2=e,this.dataIndex=r==null?-1:r}return a.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,r=e.edgeData.getItemModel(this.dataIndex);return r.getModel(t)}},a.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},a}();function Xt(a,t){return{getValue:function(e){var r=this[a][t];return r.getStore().get(r.getDimensionIndex(e||"value"),this.dataIndex)},setVisual:function(e,r){this.dataIndex>=0&&this[a][t].setItemVisual(this.dataIndex,e,r)},getVisual:function(e){return this[a][t].getItemVisual(this.dataIndex,e)},setLayout:function(e,r){this.dataIndex>=0&&this[a][t].setItemLayout(this.dataIndex,e,r)},getLayout:function(){return this[a][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[a][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[a][t].getRawIndex(this.dataIndex)}}}Gt(k,Xt("hostGraph","data"));Gt(Ht,Xt("hostGraph","edgeData"));var ze=Ge;function Pe(a,t,e,r,n){for(var i=new ze(r),o=0;o<a.length;o++)i.addNode(wt(a[o].id,a[o].name,o),o);for(var s=[],u=[],d=0,o=0;o<t.length;o++){var c=t[o],g=c.source,p=c.target;i.addEdge(g,p,d)&&(u.push(c),s.push(wt(Jt(c.id,null),g+" > "+p)),d++)}var v=e.get("coordinateSystem"),l;if(v==="cartesian2d"||v==="polar")l=Qt(a,e);else{var f=te.get(v),h=f?f.dimensions||[]:[];ee(h,"value")<0&&h.concat(["value"]);var x=ae(a,{coordDimensions:h,encodeDefine:e.getEncode()}).dimensions;l=new Mt(x,e),l.initData(a)}var y=new Mt(["value"],e);return y.initData(u,s),n&&n(l,y),Ve({mainData:l,struct:i,structAttr:"graph",datas:{node:l,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),i.update(),i}var $e=function(){function a(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}return a}(),Re=function(a){pt(t,a);function t(e){return a.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new $e},t.prototype.buildPath=function(e,r){var n=r.extent;e.moveTo(r.x1,r.y1),e.bezierCurveTo(r.cpx1,r.cpy1,r.cpx2,r.cpy2,r.x2,r.y2),r.orient==="vertical"?(e.lineTo(r.x2+n,r.y2),e.bezierCurveTo(r.cpx2+n,r.cpy2,r.cpx1+n,r.cpy1,r.x1+n,r.y1)):(e.lineTo(r.x2,r.y2+n),e.bezierCurveTo(r.cpx2,r.cpy2+n,r.cpx1,r.cpy1+n,r.x1,r.y1+n)),e.closePath()},t.prototype.highlight=function(){re(this)},t.prototype.downplay=function(){ne(this)},t}(ie),Be=function(a){pt(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e._focusAdjacencyDisabled=!1,e}return t.prototype.render=function(e,r,n){var i=this,o=e.getGraph(),s=this.group,u=e.layoutInfo,d=u.width,c=u.height,g=e.getData(),p=e.getData("edge"),v=e.get("orient");this._model=e,s.removeAll(),s.x=u.x,s.y=u.y,o.eachEdge(function(l){var f=new Re,h=st(f);h.dataIndex=l.dataIndex,h.seriesIndex=e.seriesIndex,h.dataType="edge";var x=l.getModel(),y=x.getModel("lineStyle"),I=y.get("curveness"),L=l.node1.getLayout(),D=l.node1.getModel(),_=D.get("localX"),S=D.get("localY"),A=l.node2.getLayout(),xt=l.node2.getModel(),Y=xt.get("localX"),O=xt.get("localY"),$=l.getLayout(),T,C,G,z,J,Q,tt,et;switch(f.shape.extent=Math.max(1,$.dy),f.shape.orient=v,v==="vertical"?(T=(_!=null?_*d:L.x)+$.sy,C=(S!=null?S*c:L.y)+L.dy,G=(Y!=null?Y*d:A.x)+$.ty,z=O!=null?O*c:A.y,J=T,Q=C*(1-I)+z*I,tt=G,et=C*I+z*(1-I)):(T=(_!=null?_*d:L.x)+L.dx,C=(S!=null?S*c:L.y)+$.sy,G=Y!=null?Y*d:A.x,z=(O!=null?O*c:A.y)+$.ty,J=T*(1-I)+G*I,Q=C,tt=T*I+G*(1-I),et=z),f.setShape({x1:T,y1:C,x2:G,y2:z,cpx1:J,cpy1:Q,cpx2:tt,cpy2:et}),f.useStyle(y.getItemStyle()),f.style.fill){case"source":f.style.fill=l.node1.getVisual("color"),f.style.decal=l.node1.getVisual("style").decal;break;case"target":f.style.fill=l.node2.getVisual("color"),f.style.decal=l.node2.getVisual("style").decal;break;case"gradient":var It=l.node1.getVisual("color"),Lt=l.node2.getVisual("color");dt(It)&&dt(Lt)&&(f.style.fill=new oe(0,0,+(v==="horizontal"),+(v==="vertical"),[{color:It,offset:0},{color:Lt,offset:1}]))}var at=x.getModel("emphasis");Et(f,x,"lineStyle",function(Ft){return Ft.getItemStyle()}),s.add(f),p.setItemGraphicEl(l.dataIndex,f);var Vt=at.get("focus");bt(f,Vt==="adjacency"?l.getAdjacentDataIndices():Vt,at.get("blurScope"),at.get("disabled")),st(f).dataType="edge"}),o.eachNode(function(l){var f=l.getLayout(),h=l.getModel(),x=h.get("localX"),y=h.get("localY"),I=h.getModel("emphasis"),L=new zt({shape:{x:x!=null?x*d:f.x,y:y!=null?y*c:f.y,width:f.dx,height:f.dy},style:h.getModel("itemStyle").getItemStyle(),z2:10});se(L,ue(h),{labelFetcher:e,labelDataIndex:l.dataIndex,defaultText:l.id}),L.disableLabelAnimation=!0,L.setStyle("fill",l.getVisual("color")),L.setStyle("decal",l.getVisual("style").decal),Et(L,h),s.add(L),g.setItemGraphicEl(l.dataIndex,L),st(L).dataType="node";var D=I.get("focus");bt(L,D==="adjacency"?l.getAdjacentDataIndices():D,I.get("blurScope"),I.get("disabled"))}),g.eachItemGraphicEl(function(l,f){var h=g.getItemModel(f);h.get("draggable")&&(l.drift=function(x,y){i._focusAdjacencyDisabled=!0,this.shape.x+=x,this.shape.y+=y,this.dirty(),n.dispatchAction({type:"dragNode",seriesId:e.id,dataIndex:g.getRawIndex(f),localX:this.shape.x/d,localY:this.shape.y/c})},l.ondragend=function(){i._focusAdjacencyDisabled=!1},l.draggable=!0,l.cursor="move")}),!this._data&&e.isAnimationEnabled()&&s.setClipPath(Ne(s.getBoundingRect(),e,function(){s.removeClipPath()})),this._data=e.getData()},t.prototype.dispose=function(){},t.type="sankey",t}(le);function Ne(a,t,e){var r=new zt({shape:{x:a.x-10,y:a.y-10,width:0,height:a.height+20}});return ce(r,{shape:{width:a.width+20}},t,e),r}var He=Be,Xe=function(a){pt(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.getInitialData=function(e,r){var n=e.edges||e.links,i=e.data||e.nodes,o=e.levels;this.levelModels=[];for(var s=this.levelModels,u=0;u<o.length;u++)o[u].depth!=null&&o[u].depth>=0&&(s[o[u].depth]=new de(o[u],this,r));if(i&&n){var d=Pe(i,n,this,!0,c);return d.data}function c(g,p){g.wrapMethod("getItemModel",function(v,l){var f=v.parentModel,h=f.getData().getItemLayout(l);if(h){var x=h.depth,y=f.levelModels[x];y&&(v.parentModel=y)}return v}),p.wrapMethod("getItemModel",function(v,l){var f=v.parentModel,h=f.getGraph().getEdgeByIndex(l),x=h.node1.getLayout();if(x){var y=x.depth,I=f.levelModels[y];I&&(v.parentModel=I)}return v})}},t.prototype.setNodePosition=function(e,r){var n=this.option.data||this.option.nodes,i=n[e];i.localX=r[0],i.localY=r[1]},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(e,r,n){function i(v){return isNaN(v)||v==null}if(n==="edge"){var o=this.getDataParams(e,n),s=o.data,u=o.value,d=s.source+" -- "+s.target;return kt("nameValue",{name:d,value:u,noValue:i(u)})}else{var c=this.getGraph().getNodeByIndex(e),g=c.getLayout().value,p=this.getDataParams(e,n).data.name;return kt("nameValue",{name:p!=null?p+"":null,value:g,noValue:i(g)})}},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(e,r){var n=a.prototype.getDataParams.call(this,e,r);if(n.value==null&&r==="node"){var i=this.getGraph().getNodeByIndex(e),o=i.getLayout().value;n.value=o}return n},t.type="series.sankey",t.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},t}(fe),je=Xe;function Fe(a,t){a.eachSeriesByType("sankey",function(e){var r=e.get("nodeWidth"),n=e.get("nodeGap"),i=Ye(e,t);e.layoutInfo=i;var o=i.width,s=i.height,u=e.getGraph(),d=u.nodes,c=u.edges;Ue(d);var g=he(d,function(f){return f.getLayout().value===0}),p=g.length!==0?0:e.get("layoutIterations"),v=e.get("orient"),l=e.get("nodeAlign");Oe(d,c,r,n,o,s,p,v,l)})}function Ye(a,t){return ge(a.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Oe(a,t,e,r,n,i,o,s,u){We(a,t,e,n,i,s,u),Je(a,t,i,n,r,o,s),sa(a,s)}function Ue(a){m(a,function(t){var e=M(t.outEdges,Z),r=M(t.inEdges,Z),n=t.getValue()||0,i=Math.max(e,r,n);t.setLayout({value:i},!0)})}function We(a,t,e,r,n,i,o){for(var s=[],u=[],d=[],c=[],g=0,p=0;p<t.length;p++)s[p]=1;for(var p=0;p<a.length;p++)u[p]=a[p].inEdges.length,u[p]===0&&d.push(a[p]);for(var v=-1;d.length;){for(var l=0;l<d.length;l++){var f=d[l],h=f.hostGraph.data.getRawDataItem(f.dataIndex),x=h.depth!=null&&h.depth>=0;x&&h.depth>v&&(v=h.depth),f.setLayout({depth:x?h.depth:g},!0),i==="vertical"?f.setLayout({dy:e},!0):f.setLayout({dx:e},!0);for(var y=0;y<f.outEdges.length;y++){var I=f.outEdges[y],L=t.indexOf(I);s[L]=0;var D=I.node2,_=a.indexOf(D);--u[_]===0&&c.indexOf(D)<0&&c.push(D)}}++g,d=c,c=[]}for(var p=0;p<s.length;p++)if(s[p]===1)throw new Error("Sankey is a DAG, the original data has cycle!");var S=v>g-1?v:g-1;o&&o!=="left"&&qe(a,o,i,S);var A=i==="vertical"?(n-e)/S:(r-e)/S;Ze(a,A,i)}function jt(a){var t=a.hostGraph.data.getRawDataItem(a.dataIndex);return t.depth!=null&&t.depth>=0}function qe(a,t,e,r){if(t==="right"){for(var n=[],i=a,o=0;i.length;){for(var s=0;s<i.length;s++){var u=i[s];u.setLayout({skNodeHeight:o},!0);for(var d=0;d<u.inEdges.length;d++){var c=u.inEdges[d];n.indexOf(c.node1)<0&&n.push(c.node1)}}i=n,n=[],++o}m(a,function(g){jt(g)||g.setLayout({depth:Math.max(0,r-g.getLayout().skNodeHeight)},!0)})}else t==="justify"&&Ke(a,r)}function Ke(a,t){m(a,function(e){!jt(e)&&!e.outEdges.length&&e.setLayout({depth:t},!0)})}function Ze(a,t,e){m(a,function(r){var n=r.getLayout().depth*t;e==="vertical"?r.setLayout({y:n},!0):r.setLayout({x:n},!0)})}function Je(a,t,e,r,n,i,o){var s=Qe(a,o);ta(s,t,e,r,n,o),lt(s,n,e,r,o);for(var u=1;i>0;i--)u*=.99,ea(s,u,o),lt(s,n,e,r,o),oa(s,u,o),lt(s,n,e,r,o)}function Qe(a,t){var e=[],r=t==="vertical"?"y":"x",n=ve(a,function(i){return i.getLayout()[r]});return n.keys.sort(function(i,o){return i-o}),m(n.keys,function(i){e.push(n.buckets.get(i))}),e}function ta(a,t,e,r,n,i){var o=1/0;m(a,function(s){var u=s.length,d=0;m(s,function(g){d+=g.getLayout().value});var c=i==="vertical"?(r-(u-1)*n)/d:(e-(u-1)*n)/d;c<o&&(o=c)}),m(a,function(s){m(s,function(u,d){var c=u.getLayout().value*o;i==="vertical"?(u.setLayout({x:d},!0),u.setLayout({dx:c},!0)):(u.setLayout({y:d},!0),u.setLayout({dy:c},!0))})}),m(t,function(s){var u=+s.getValue()*o;s.setLayout({dy:u},!0)})}function lt(a,t,e,r,n){var i=n==="vertical"?"x":"y";m(a,function(o){o.sort(function(f,h){return f.getLayout()[i]-h.getLayout()[i]});for(var s,u,d,c=0,g=o.length,p=n==="vertical"?"dx":"dy",v=0;v<g;v++)u=o[v],d=c-u.getLayout()[i],d>0&&(s=u.getLayout()[i]+d,n==="vertical"?u.setLayout({x:s},!0):u.setLayout({y:s},!0)),c=u.getLayout()[i]+u.getLayout()[p]+t;var l=n==="vertical"?r:e;if(d=c-t-l,d>0){s=u.getLayout()[i]-d,n==="vertical"?u.setLayout({x:s},!0):u.setLayout({y:s},!0),c=s;for(var v=g-2;v>=0;--v)u=o[v],d=u.getLayout()[i]+u.getLayout()[p]+t-c,d>0&&(s=u.getLayout()[i]-d,n==="vertical"?u.setLayout({x:s},!0):u.setLayout({y:s},!0)),c=u.getLayout()[i]}})}function ea(a,t,e){m(a.slice().reverse(),function(r){m(r,function(n){if(n.outEdges.length){var i=M(n.outEdges,aa,e)/M(n.outEdges,Z);if(isNaN(i)){var o=n.outEdges.length;i=o?M(n.outEdges,ra,e)/o:0}if(e==="vertical"){var s=n.getLayout().x+(i-E(n,e))*t;n.setLayout({x:s},!0)}else{var u=n.getLayout().y+(i-E(n,e))*t;n.setLayout({y:u},!0)}}})})}function aa(a,t){return E(a.node2,t)*a.getValue()}function ra(a,t){return E(a.node2,t)}function na(a,t){return E(a.node1,t)*a.getValue()}function ia(a,t){return E(a.node1,t)}function E(a,t){return t==="vertical"?a.getLayout().x+a.getLayout().dx/2:a.getLayout().y+a.getLayout().dy/2}function Z(a){return a.getValue()}function M(a,t,e){for(var r=0,n=a.length,i=-1;++i<n;){var o=+t(a[i],e);isNaN(o)||(r+=o)}return r}function oa(a,t,e){m(a,function(r){m(r,function(n){if(n.inEdges.length){var i=M(n.inEdges,na,e)/M(n.inEdges,Z);if(isNaN(i)){var o=n.inEdges.length;i=o?M(n.inEdges,ia,e)/o:0}if(e==="vertical"){var s=n.getLayout().x+(i-E(n,e))*t;n.setLayout({x:s},!0)}else{var u=n.getLayout().y+(i-E(n,e))*t;n.setLayout({y:u},!0)}}})})}function sa(a,t){var e=t==="vertical"?"x":"y";m(a,function(r){r.outEdges.sort(function(n,i){return n.node2.getLayout()[e]-i.node2.getLayout()[e]}),r.inEdges.sort(function(n,i){return n.node1.getLayout()[e]-i.node1.getLayout()[e]})}),m(a,function(r){var n=0,i=0;m(r.outEdges,function(o){o.setLayout({sy:n},!0),n+=o.getLayout().dy}),m(r.inEdges,function(o){o.setLayout({ty:i},!0),i+=o.getLayout().dy})})}function ua(a){a.eachSeriesByType("sankey",function(t){var e=t.getGraph(),r=e.nodes;if(r.length){var n=1/0,i=-1/0;m(r,function(o){var s=o.getLayout().value;s<n&&(n=s),s>i&&(i=s)}),m(r,function(o){var s=new Ce({type:"color",mappingMethod:"linear",dataExtent:[n,i],visual:t.get("color")}),u=s.mapValueToVisual(o.getLayout().value),d=o.getModel().get(["itemStyle","color"]);d!=null?(o.setVisual("color",d),o.setVisual("style",{fill:d})):(o.setVisual("color",u),o.setVisual("style",{fill:u}))})}})}function la(a){a.registerChartView(He),a.registerSeriesModel(je),a.registerLayout(Fe),a.registerVisual(ua),a.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(t,e){e.eachComponent({mainType:"series",subType:"sankey",query:t},function(r){r.setNodePosition(t.dataIndex,[t.localX,t.localY])})})}const ca="_4m";var da={sankeyChart:ca};const fa=$t({props:{class:null,data:null},setup(a){const t=a;pe([la,me]);const e=N(()=>t.class),r=N(()=>({series:{type:"sankey",animation:!1,label:{formatter:"{b}",textBorderWidth:0,fontWeight:"var(--font-weight-l)",fontFamily:"var(--font-family)",color:"var(--chart-label)"},lineStyle:{color:"source",curveness:.5},nodeGap:10,nodeWidth:7,left:0,right:0,links:t.data.links,data:t.data.labels.map(n=>({name:n.name,id:n.id,itemStyle:{color:n.color},label:n.align==="left"?{align:"right",padding:[0,20,0,0]}:void 0}))}}));return(n,i)=>(ft(),gt(ye,{class:Rt([n.$style.sankeyChart,H(e)]),options:H(r)},null,8,["class","options"]))}}),ga={$style:da};var ha=Pt(fa,[["__cssModules",ga]]);const va="_16";var pa={distributionChart:va};const ya=$t({props:{class:null},setup(a){const t=a,e=N(()=>t.class),{state:r}=xe(),{n}=Ie(),i=N(()=>{const s=w(U(r.income)),u=w(U(r.expenses));return!s||!u}),o=N(()=>{const s=l=>n(l,"currency"),u=w(U(r.income)),d=w(U(r.expenses)),c=[],g=[],p=l=>`hsl(${l}, var(--chart-generic-saturation), var(--chart-generic-lightness))`,v={id:Le(),name:`Income (${s(u)})`,color:p(120)};c.push(v);for(const l of r.income){const f=w(l.budgets.flatMap(h=>h.values));c.push({id:l.id,name:`${l.name} (${s(f)})`,color:p(60+60*(f/u))}),g.push({target:v.id,source:l.id,value:f});for(let h=0;h<l.budgets.length;h++){const x=l.budgets[h],y=w(x.values);y&&(c.push({id:x.id,name:`${x.name} (${s(y)})`,color:p(60+60*(y/u))}),g.push({target:l.id,source:x.id,value:y}))}}for(const l of r.expenses){const f=w(l.budgets.flatMap(h=>h.values));c.push({id:l.id,name:`${l.name} (${s(f)})`,color:p(60*(1-f/d))}),g.push({target:l.id,source:v.id,value:f});for(let h=0;h<l.budgets.length;h++){const x=l.budgets[h],y=w(x.values);y&&(c.push({id:x.id,name:`${x.name} (${s(y)})`,color:p(60*(1-y/d)),align:"left"}),g.push({target:x.id,source:l.id,value:y}))}}return{labels:c,links:g}});return(s,u)=>H(i)?(ft(),gt(Yt,{key:0})):(ft(),gt(ha,{key:1,class:Rt([s.$style.distributionChart,H(e)]),data:H(o)},null,8,["class","data"]))}}),ma={$style:pa};var Ma=Pt(ya,[["__cssModules",ma]]);export{Ma as default};
