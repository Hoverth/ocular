import{u as x,i as ee,a as te,b as se,_ as le}from"./EChart.vue_vue_type_script_setup_true_lang-8e15f249.js";import{d as A,c as k,o as m,i as U,n as u,K as ne,x as I,a as f,l as g,k as v,s as oe,b as c,t as L,p as ae,_ as P,L as Z,M as H,e as K,N as ue,O as J,P as Q,y as re,f as X,B as z,G as O,F as w,r as E,w as j}from"./index-b1912267.js";import{t as ce}from"./budgets-531db56b.js";import{P as de}from"./Pane-2e0c6f34.js";import{B as S}from"./Button-c92f31ae.js";import{C as F}from"./Currency-13396e42.js";import{u as pe}from"./useMonthNames-e9f68ba6.js";const ie=A({__name:"MiniChart",props:{class:{},values:{}},setup(b){const _=b;x([ee,te,se]);const l=k(()=>_.class),d=k(()=>({xAxis:{type:"category",show:!1},yAxis:{show:!1,min:Math.min(..._.values)},grid:{top:"15%",left:0,bottom:"20%",right:0},series:[{data:_.values,type:"line",smooth:!0,showSymbol:!1,silent:!0}]}));return(p,i)=>(m(),U(le,{class:u(l.value),options:d.value},null,8,["class","options"]))}}),o=ne({group:void 0,source:void 0,target:void 0,type:void 0}),me=A({__name:"Draggable",props:{text:{type:Function},name:{},id:{}},emits:["drop"],setup(b,{emit:_}){const l=b,d=I(),p=I(),i=I(0),h=I(0),C=k(()=>l.id===o.target&&o.type),N=k(()=>C.value?o.type==="before"?"skip-up-line":"skip-down-line":"draggable"),M=k(()=>{var s;return o.target&&o.target&&o.source?(s=l.text)==null?void 0:s.call(l,o):void 0}),G=s=>{s.dataTransfer&&p.value&&(o.group=l.name,o.source=l.id,s.dataTransfer.effectAllowed="move",s.dataTransfer.setDragImage(p.value,1/0,1/0),s.dataTransfer.setData("text/plain",l.name))},B=s=>{i.value=s.pageX,h.value=s.pageY},a=s=>{var e;if(o.group===l.name){const y=(e=d.value)==null?void 0:e.getBoundingClientRect();if(s.preventDefault(),y&&l.id!==o.source){const n=s.pageY<y.top+y.height/2?"before":"after";o.target=l.id,o.type=n}}},t=s=>{s.pageX&&s.pageY&&o.target!==l.id&&(o.type=void 0,o.target=void 0)},$=()=>{o.type=void 0,o.target=void 0,o.source=void 0,o.group=void 0},r=s=>{o.target&&o.target&&o.source&&_("drop",o),s.preventDefault()};return(s,e)=>(m(),f("div",{ref_key:"draggable",ref:d,class:u(s.$style.draggable),draggable:"true",onDragend:$,onDragover:a,onDragleave:t,onDrop:r,onDrag:B,onDragstart:G},[g(S,{color:v(o).group===l.name?"primary":"dimmed",icon:N.value,textual:""},null,8,["color","icon"]),v(o).source===l.id&&h.value&&i.value&&M.value?(m(),f("div",{key:0,style:oe({top:`${h.value+5}px`,left:`${i.value+5}px`}),class:u(s.$style.content)},[c("span",{class:u(s.$style.text)},L(M.value),3)],6)):ae("",!0),c("div",{ref_key:"element",ref:p,class:u(s.$style.hidden)},"hidden",2)],34))}}),ge="lb",ve="mb",ye="nb",fe="ob",$e={draggable:ge,content:ve,text:ye,hidden:fe},be={$style:$e},W=P(me,[["__cssModules",be]]),_e=["type","value"],he=A({__name:"CurrencyCell",props:Z({max:{default:Number.MAX_SAFE_INTEGER}},{modelValue:{}}),emits:["update:modelValue"],setup(b){const _=b,l=H(b,"modelValue"),d=I(),p=I(!1),{n:i}=K(),h=k(()=>p.value||!l.value?l.value||"":i(l.value,"currency")),C=a=>{const t=Number((a==null?void 0:a.trim())||NaN);l.value=Number.isNaN(t)?0:t},N=a=>{a.key==="-"&&a.preventDefault()},M=()=>{p.value=!0,Q(()=>d.value.select())},G=a=>C(a.target.value),B=a=>{var t;return C((t=a.clipboardData)==null?void 0:t.getData("text/plain").trim())};return ue(()=>l.value,(a,t)=>{(a??0)>_.max&&t!==void 0&&(l.value=t)}),(a,t)=>(m(),f("input",{ref_key:"input",ref:d,class:u(a.$style.currencyCell),type:p.value?"number":"text",value:h.value,onBlur:t[0]||(t[0]=$=>p.value=!1),onFocus:M,onInput:G,onKeydown:[N,t[1]||(t[1]=J((...$)=>{var r,s;return((r=d.value)==null?void 0:r.blur)&&((s=d.value)==null?void 0:s.blur(...$))},["enter"]))],onPaste:B},null,42,_e))}}),Ce="wb",Be={currencyCell:Ce},ke={$style:Be},Me=P(he,[["__cssModules",ke]]),De=["value"],Ge=A({__name:"TextCell",props:Z({inline:{type:Boolean,default:!1}},{modelValue:{}}),emits:["update:modelValue"],setup(b){const _=b,l=H(b,"modelValue"),d=I(),p=re(),i=I(!1),h=k(()=>[p.textInput,{[p.empty]:!l.value,[p.inline]:_.inline}]),C=()=>{i.value=!0,Q(()=>{d.value.select()})},N=M=>{l.value=M.target.value};return(M,G)=>(m(),f("span",{class:u(h.value)},[c("input",{ref_key:"input",ref:d,value:l.value,class:u(M.$style.input),type:"text",onBlur:G[0]||(G[0]=B=>i.value=!1),onFocus:C,onInput:N,onKeydown:G[1]||(G[1]=J((...B)=>{var a,t;return((a=d.value)==null?void 0:a.blur)&&((t=d.value)==null?void 0:t.blur(...B))},["enter"]))},null,42,De)],2))}}),Ve="Cb",Ne="Db",we="Eb",Ie="Fb",Te={textInput:Ve,input:Ne,inline:we,empty:Ie},Ae={$style:Te},q=P(Ge,[["__cssModules",Ae]]),Fe=c("span",null,null,-1),Ee=c("span",{style:{"grid-column":"3 / 16"}},null,-1),Pe=A({__name:"BudgetGroup",props:{group:{}},setup(b){const _=b,{moveBudget:l,removeBudgetGroup:d,getBudget:p,addBudget:i,setBudgetName:h,setBudgetGroupName:C,setBudget:N,removeBudget:M,isCurrentMonth:G}=X(),{t:B}=K(),a=k(()=>{const e=new Array(12).fill(0);for(const{values:y}of _.group.budgets)for(let n=0;n<y.length;n++)e[n]+=y[n];return e}),t=k(()=>z(a.value)),$=k(()=>O(a.value)),r=e=>{const[y,n]=e.source?p(e.source)??[]:[],[D,T]=e.target?p(e.target)??[]:[];if(n&&y){if(T&&D){const V=y.id===D.id,R=V?n.name:`${y.name} » ${n.name}`,Y=V?T.name:`${D.name} » ${T.name}`;return e.type==="before"?B("budget.prepend",{from:R,to:Y}):B("budget.append",{from:R,to:Y})}return B("budget.move",{from:n.name})}},s=e=>{l(e.source,e.target,e.type==="after")};return(e,y)=>(m(),f(w,null,[g(S,{color:"dimmed",icon:"close-circle",textual:"",onClick:y[0]||(y[0]=n=>v(d)(e.group.id))}),g(q,{class:u([e.$style.top,e.$style.start]),"model-value":e.group.name,inline:"","onUpdate:modelValue":y[1]||(y[1]=n=>v(C)(e.group.id,n))},null,8,["class","model-value"]),(m(!0),f(w,null,E(a.value,(n,D)=>(m(),f("span",{key:D,class:u(e.$style.top)},[g(F,{value:n},null,8,["value"])],2))),128)),c("span",{class:u(e.$style.top)},[c("span",null,L(v(B)("budget.total")),1)],2),c("span",{class:u([e.$style.top,e.$style.end])},[c("span",null,L(v(B)("budget.average")),1)],2),(m(!0),f(w,null,E(e.group.budgets,(n,D)=>(m(),f(w,{key:n.id+D},[g(W,{id:n.id,name:"budget-group",text:r,onDrop:s},null,8,["id"]),g(S,{color:"dimmed",icon:"close-circle",textual:"",onClick:T=>v(M)(n.id)},null,8,["onClick"]),c("span",{class:u(e.$style.header)},[g(q,{"model-value":n.name,"onUpdate:modelValue":T=>v(h)(n.id,T)},null,8,["model-value","onUpdate:modelValue"])],2),(m(!0),f(w,null,E(n.values,(T,V)=>(m(),f("span",{key:n.id+V,class:u([e.$style.currencyCell,{[e.$style.even]:D%2,[e.$style.firstRow]:D===0,[e.$style.firstColumn]:V===0,[e.$style.currentMonth]:v(G)(V),[e.$style.tlc]:D===0&&V===0,[e.$style.trc]:D===0&&V===11,[e.$style.blc]:D===e.group.budgets.length-1&&V===0,[e.$style.brc]:D===e.group.budgets.length-1&&V===11}])},[g(Me,{"model-value":n.values[V],"onUpdate:modelValue":R=>v(N)(n.id,V,R)},null,8,["model-value","onUpdate:modelValue"])],2))),128)),g(F,{class:u(e.$style.meta),value:v(z)(n.values)},null,8,["class","value"]),g(F,{class:u(e.$style.meta),value:v(O)(n.values)},null,8,["class","value"])],64))),128)),Fe,g(S,{icon:"plus",class:u(e.$style.addBudgetBtn),textual:"",color:"success",onClick:y[2]||(y[2]=n=>v(i)(e.group.id))},null,8,["class"]),Ee,g(F,{class:u([e.$style.meta,e.$style.bold]),value:t.value},null,8,["class","value"]),g(F,{class:u([e.$style.meta,e.$style.bold]),value:$.value},null,8,["class","value"])],64))}}),Se="X_",Le="Y_",Re="Z_",Ue="_b",Ke="ab",Xe="bb",Ye="cb",ze="db",Oe="eb",je="fb",qe="gb",Ze="hb",He="ib",Je="jb",Qe="kb",We={header:Se,meta:Le,bold:Re,top:Ue,start:Ke,end:Xe,currencyCell:Ye,firstRow:ze,firstColumn:Oe,currentMonth:je,even:qe,tlc:Ze,trc:He,blc:Je,brc:Qe},xe={$style:We},et=P(Pe,[["__cssModules",xe]]),tt=c("span",null,null,-1),st=c("span",null,null,-1),lt=c("span",null,null,-1),nt=c("span",null,null,-1),ot=c("span",null,null,-1),at=c("span",null,null,-1),ut=c("span",null,null,-1),rt=c("span",null,null,-1),ct=c("span",null,null,-1),dt=c("span",null,null,-1),pt=A({__name:"BudgetGroups",props:{type:{}},setup(b){const _=b,{state:l,moveBudgetGroup:d,addBudgetGroup:p,getBudgetGroup:i,isCurrentMonth:h}=X(),{t:C}=K(),N=k(()=>l[_.type]),M=pe(),G=k(()=>{const t=new Array(12).fill(0);for(const{budgets:$}of N.value)for(const{values:r}of $)for(let s=0;s<r.length;s++)t[s]+=r[s];return t}),B=t=>{const $=t.source?i(t.source):void 0,r=t.target?i(t.target):void 0;if($)return r?t.type==="before"?C("budget.prepend",{from:$.name,to:r.name}):C("budget.append",{from:$.name,to:r.name}):C("budget.move",{from:$.name})},a=t=>{d(t.source,t.target,t.type==="after")};return(t,$)=>(m(),f("div",{class:u(t.$style.budgetGroups)},[tt,st,lt,(m(!0),f(w,null,E(v(M),(r,s)=>(m(),f("span",{key:r,class:u([t.$style.month,{[t.$style.current]:v(h)(s)}])},[c("span",null,L(r),1)],2))),128)),nt,ot,at,ut,c("span",{class:u(t.$style.sum)},L(v(C)("budget.totals")),3),(m(!0),f(w,null,E(G.value,(r,s)=>(m(),U(F,{key:s,value:r,class:u(t.$style.sum)},null,8,["value","class"]))),128)),rt,ct,(m(!0),f(w,null,E(N.value,r=>(m(),f(w,{key:r.id},[g(W,{id:r.id,text:B,name:"budget-groups",onDrop:a},null,8,["id"]),g(et,{group:r},null,8,["group"])],64))),128)),dt,g(S,{class:u(t.$style.addGroupBtn),icon:"plus",text:v(C)("budget.addGroup"),onClick:$[0]||($[0]=r=>v(p)(t.type))},null,8,["class","text"])],2))}}),it="p_",mt="q_",gt="r_",vt="s_",yt="t_",ft={budgetGroups:it,sum:mt,month:gt,current:vt,addGroupBtn:yt},$t={$style:ft},bt=P(pt,[["__cssModules",$t]]),_t=A({__name:"BudgetPane",props:{title:{},type:{}},setup(b){const _=b,{state:l}=X(),d=k(()=>ce(l[_.type])),p=k(()=>d.value.reduce((i,h)=>i+h,0));return(i,h)=>(m(),U(de,{amount:p.value,title:i.title},{header:j(()=>[g(ie,{class:u(i.$style.miniChart),values:d.value},null,8,["class","values"])]),default:j(()=>[g(bt,{type:i.type},null,8,["type"])]),_:1},8,["amount","title"]))}}),ht="r",Ct={miniChart:ht},Bt={$style:Ct},It=P(_t,[["__cssModules",Bt]]);export{It as B};
