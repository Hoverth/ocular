import{u as W,i as Z,a as x,b as ee,_ as te}from"./EChart.vue_vue_type_script_setup_true_lang-611d826d.js";import{d as A,j as k,o as g,c as P,n as a,I as se,s as N,i as $,g as y,f as v,q as le,h as c,t as E,m as ne,_ as R,u as K,J as oe,K as H,L as J,v as ae,a as X,F as I,r as S,z as q,D as z,w as j}from"./index-a6bb7ba6.js";import{t as ue}from"./budgets-531db56b.js";import{P as re}from"./Pane-36700e0a.js";import{B as U}from"./Button-942b3a32.js";import{C as F}from"./Currency-43832586.js";import{u as ce}from"./useMonthNames-f90391db.js";const de=A({__name:"MiniChart",props:{class:{},values:{}},setup(M){const b=M;W([Z,x,ee]);const s=k(()=>b.class),d=k(()=>({xAxis:{type:"category",show:!1},yAxis:{show:!1,min:Math.min(...b.values)},grid:{top:"15%",left:0,bottom:"20%",right:0},series:[{data:b.values,type:"line",smooth:!0,showSymbol:!1,silent:!0}]}));return(i,m)=>(g(),P(te,{class:a(s.value),options:d.value},null,8,["class","options"]))}}),o=se({group:void 0,source:void 0,target:void 0,type:void 0}),pe=A({__name:"Draggable",props:{text:{type:Function},name:{},id:{}},emits:["drop"],setup(M,{emit:b}){const s=M,d=N(),i=N(),m=N(0),h=N(0),C=k(()=>s.id===o.target&&o.type),w=k(()=>C.value?o.type==="before"?"skip-up-line":"skip-down-line":"draggable"),B=k(()=>{var t;return o.target&&o.target&&o.source?(t=s.text)==null?void 0:t.call(s,o):void 0}),G=t=>{t.dataTransfer&&i.value&&(o.group=s.name,o.source=s.id,t.dataTransfer.effectAllowed="move",t.dataTransfer.setDragImage(i.value,1/0,1/0),t.dataTransfer.setData("text/plain",s.name))},u=t=>{m.value=t.pageX,h.value=t.pageY},p=t=>{var e;if(o.group===s.name){const f=(e=d.value)==null?void 0:e.getBoundingClientRect();if(t.preventDefault(),f&&s.id!==o.source){const n=t.pageY<f.top+f.height/2?"before":"after";o.target=s.id,o.type=n}}},l=t=>{t.pageX&&t.pageY&&o.target!==s.id&&(o.type=void 0,o.target=void 0)},_=()=>{o.type=void 0,o.target=void 0,o.source=void 0,o.group=void 0},r=t=>{o.target&&o.target&&o.source&&b("drop",o),t.preventDefault()};return(t,e)=>(g(),$("div",{ref_key:"draggable",ref:d,class:a(t.$style.draggable),draggable:"true",onDragend:_,onDragover:p,onDragleave:l,onDrop:r,onDrag:u,onDragstart:G},[y(U,{color:v(o).group===s.name?C.value?"primary":"dark":"dimmed",icon:w.value,textual:""},null,8,["color","icon"]),v(o).source===s.id&&h.value&&m.value&&B.value?(g(),$("div",{key:0,style:le({top:`${h.value+5}px`,left:`${m.value+5}px`}),class:a(t.$style.content)},[c("span",{class:a(t.$style.text)},E(B.value),3)],6)):ne("",!0),c("div",{ref_key:"element",ref:i,class:a(t.$style.hidden)},"hidden",2)],34))}}),ie="F_",me="G_",ge="H_",ye="I_",ve={draggable:ie,content:me,text:ge,hidden:ye},fe={$style:ve},Q=R(pe,[["__cssModules",fe]]),$e=["type","value"],be=A({__name:"CurrencyCell",props:{modelValue:{},max:{default:Number.MAX_SAFE_INTEGER}},emits:["update:modelValue"],setup(M,{emit:b}){const s=M,d=N(),i=N(!1),{n:m}=K(),h=k(()=>i.value||!s.modelValue?s.modelValue||"":m(s.modelValue,"currency")),C=u=>{b("update:modelValue",Math.max(u,0))},w=u=>{u.key==="-"&&u.preventDefault()},B=()=>{i.value=!0,J(()=>{d.value.select()})},G=u=>{const p=Number(u.target.value);!Number.isNaN(p)&&C(p)};return oe(()=>s.modelValue,(u,p)=>{(u??0)>s.max&&p!==void 0&&b("update:modelValue",p)}),(u,p)=>(g(),$("input",{ref_key:"input",ref:d,class:a(u.$style.currencyCell),type:i.value?"number":"text",value:h.value,onBlur:p[0]||(p[0]=l=>i.value=!1),onFocus:B,onInput:G,onKeydown:[w,p[1]||(p[1]=H((...l)=>{var _,r;return((_=d.value)==null?void 0:_.blur)&&((r=d.value)==null?void 0:r.blur(...l))},["enter"]))]},null,42,$e))}}),_e="jb",he={currencyCell:_e},Ce={$style:he},Be=R(be,[["__cssModules",Ce]]),ke=["value"],Me=A({__name:"TextCell",props:{modelValue:{},inline:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(M,{emit:b}){const s=M,d=N(),i=ae(),m=N(!1),h=k(()=>[i.textInput,{[i.empty]:!s.modelValue,[i.inline]:s.inline}]),C=()=>{m.value=!0,J(()=>{d.value.select()})},w=B=>{b("update:modelValue",B.target.value)};return(B,G)=>(g(),$("span",{class:a(h.value)},[c("input",{ref_key:"input",ref:d,value:B.modelValue,class:a(B.$style.input),type:"text",onBlur:G[0]||(G[0]=u=>m.value=!1),onFocus:C,onInput:w,onKeydown:G[1]||(G[1]=H((...u)=>{var p,l;return((p=d.value)==null?void 0:p.blur)&&((l=d.value)==null?void 0:l.blur(...u))},["enter"]))},null,42,ke)],2))}}),Ve="pb",Ge="qb",De="rb",we="sb",Ie={textInput:Ve,input:Ge,inline:De,empty:we},Ne={$style:Ie},O=R(Me,[["__cssModules",Ne]]),Te=c("span",null,null,-1),Ae=c("span",{style:{"grid-column":"3 / 16"}},null,-1),Fe=A({__name:"BudgetGroup",props:{group:{}},setup(M){const b=M,{moveBudget:s,removeBudgetGroup:d,getBudget:i,addBudget:m,setBudgetName:h,setBudgetGroupName:C,setBudget:w,removeBudget:B,isCurrentMonth:G}=X(),{t:u}=K(),p=k(()=>{const e=new Array(12).fill(0);for(const{values:f}of b.group.budgets)for(let n=0;n<f.length;n++)e[n]+=f[n];return e}),l=k(()=>q(p.value)),_=k(()=>z(p.value)),r=e=>{const[f,n]=e.source?i(e.source)??[]:[],[V,T]=e.target?i(e.target)??[]:[];if(n&&f){if(T&&V){const D=f.id===V.id,L=D?n.name:`${f.name} » ${n.name}`,Y=D?T.name:`${V.name} » ${T.name}`;return e.type==="before"?u("budget.prepend",{from:L,to:Y}):u("budget.append",{from:L,to:Y})}return u("budget.move",{from:n.name})}},t=e=>{s(e.source,e.target,e.type==="after")};return(e,f)=>(g(),$(I,null,[y(U,{color:"dimmed",icon:"close-circle",textual:"",onClick:f[0]||(f[0]=n=>v(d)(e.group.id))}),y(O,{class:a([e.$style.top,e.$style.start]),"model-value":e.group.name,inline:"","onUpdate:modelValue":f[1]||(f[1]=n=>v(C)(e.group.id,n))},null,8,["class","model-value"]),(g(!0),$(I,null,S(p.value,(n,V)=>(g(),$("span",{key:V,class:a(e.$style.top)},[y(F,{value:n},null,8,["value"])],2))),128)),c("span",{class:a(e.$style.top)},[c("span",null,E(v(u)("budget.total")),1)],2),c("span",{class:a([e.$style.top,e.$style.end])},[c("span",null,E(v(u)("budget.average")),1)],2),(g(!0),$(I,null,S(e.group.budgets,(n,V)=>(g(),$(I,{key:n.id+V},[y(Q,{id:n.id,name:"budget-group",text:r,onDrop:t},null,8,["id"]),y(U,{color:"dimmed",icon:"close-circle",textual:"",onClick:T=>v(B)(n.id)},null,8,["onClick"]),c("span",{class:a(e.$style.header)},[y(O,{"model-value":n.name,"onUpdate:modelValue":T=>v(h)(n.id,T)},null,8,["model-value","onUpdate:modelValue"])],2),(g(!0),$(I,null,S(n.values,(T,D)=>(g(),$("span",{key:n.id+D,class:a([e.$style.currencyCell,{[e.$style.even]:V%2,[e.$style.firstRow]:V===0,[e.$style.firstColumn]:D===0,[e.$style.currentMonth]:v(G)(D),[e.$style.tlc]:V===0&&D===0,[e.$style.trc]:V===0&&D===11,[e.$style.blc]:V===e.group.budgets.length-1&&D===0,[e.$style.brc]:V===e.group.budgets.length-1&&D===11}])},[y(Be,{"model-value":n.values[D],"onUpdate:modelValue":L=>v(w)(n.id,D,L)},null,8,["model-value","onUpdate:modelValue"])],2))),128)),y(F,{class:a(e.$style.meta),value:v(q)(n.values)},null,8,["class","value"]),y(F,{class:a(e.$style.meta),value:v(z)(n.values)},null,8,["class","value"])],64))),128)),Te,y(U,{icon:"plus",class:a(e.$style.addBudgetBtn),textual:"",color:"success",onClick:f[2]||(f[2]=n=>v(m)(e.group.id))},null,8,["class"]),Ae,y(F,{class:a([e.$style.meta,e.$style.bold]),value:l.value},null,8,["class","value"]),y(F,{class:a([e.$style.meta,e.$style.bold]),value:_.value},null,8,["class","value"])],64))}}),Se="O_",Re="P_",Ue="Q_",Ee="R_",Le="S_",Pe="T_",Ke="U_",Xe="V_",Ye="W_",qe="X_",ze="Y_",je="Z_",Oe="_b",He="ab",Je="bb",Qe={header:Se,meta:Re,bold:Ue,top:Ee,start:Le,end:Pe,currencyCell:Ke,firstRow:Xe,firstColumn:Ye,currentMonth:qe,even:ze,tlc:je,trc:Oe,blc:He,brc:Je},We={$style:Qe},Ze=R(Fe,[["__cssModules",We]]),xe=c("span",null,null,-1),et=c("span",null,null,-1),tt=c("span",null,null,-1),st=c("span",null,null,-1),lt=c("span",null,null,-1),nt=c("span",null,null,-1),ot=c("span",null,null,-1),at=c("span",null,null,-1),ut=c("span",null,null,-1),rt=c("span",null,null,-1),ct=A({__name:"BudgetGroups",props:{type:{}},setup(M){const b=M,{state:s,moveBudgetGroup:d,addBudgetGroup:i,getBudgetGroup:m,isCurrentMonth:h}=X(),{t:C}=K(),w=k(()=>s[b.type]),B=ce(),G=k(()=>{const l=new Array(12).fill(0);for(const{budgets:_}of w.value)for(const{values:r}of _)for(let t=0;t<r.length;t++)l[t]+=r[t];return l}),u=l=>{const _=l.source?m(l.source):void 0,r=l.target?m(l.target):void 0;if(_)return r?l.type==="before"?C("budget.prepend",{from:_.name,to:r.name}):C("budget.append",{from:_.name,to:r.name}):C("budget.move",{from:_.name})},p=l=>{d(l.source,l.target,l.type==="after")};return(l,_)=>(g(),$("div",{class:a(l.$style.budgetGroups)},[xe,et,tt,(g(!0),$(I,null,S(v(B),(r,t)=>(g(),$("span",{key:r,class:a([l.$style.month,{[l.$style.current]:v(h)(t)}])},[c("span",null,E(r),1)],2))),128)),st,lt,nt,ot,c("span",{class:a(l.$style.sum)},E(v(C)("budget.totals")),3),(g(!0),$(I,null,S(G.value,(r,t)=>(g(),P(F,{key:t,value:r,class:a(l.$style.sum)},null,8,["value","class"]))),128)),at,ut,(g(!0),$(I,null,S(w.value,r=>(g(),$(I,{key:r.id},[y(Q,{id:r.id,text:u,name:"budget-groups",onDrop:p},null,8,["id"]),y(Ze,{group:r},null,8,["group"])],64))),128)),rt,y(U,{class:a(l.$style.addGroupBtn),icon:"plus",text:v(C)("budget.addGroup"),onClick:_[0]||(_[0]=r=>v(i)(l.type))},null,8,["class","text"])],2))}}),dt="o_",pt="p_",it="q_",mt="r_",gt="s_",yt={budgetGroups:dt,sum:pt,month:it,current:mt,addGroupBtn:gt},vt={$style:yt},ft=R(ct,[["__cssModules",vt]]),$t=A({__name:"BudgetPane",props:{title:{},type:{}},setup(M){const b=M,{state:s}=X(),d=k(()=>ue(s[b.type])),i=k(()=>d.value.reduce((m,h)=>m+h,0));return(m,h)=>(g(),P(re,{amount:i.value,title:m.title},{header:j(()=>[y(de,{class:a(m.$style.miniChart),values:d.value},null,8,["class","values"])]),default:j(()=>[y(ft,{type:m.type},null,8,["type"])]),_:1},8,["amount","title"]))}}),bt="_",_t={miniChart:bt},ht={$style:_t},wt=R($t,[["__cssModules",ht]]);export{wt as B};
