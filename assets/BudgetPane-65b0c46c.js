import{u as H,i as Z,a as x,b as ee,_ as te}from"./EChart.vue_vue_type_script_setup_true_lang-4ccd8a1b.js";import{d as I,j as C,o as i,c as P,n as a,s as D,u as K,C as se,i as g,D as J,E as Q,_ as R,G as le,g as y,f,q as ne,h as d,t as U,m as W,v as oe,a as X,F as w,r as E,w as j}from"./index-c3219ec4.js";import{t as ae}from"./budgets-531db56b.js";import{P as ue}from"./Pane-1961a166.js";import{B as F}from"./Button-40b881f1.js";import{C as S}from"./Currency-c58f10b4.js";import{u as re}from"./useMonthNames-5148d64d.js";import{b as q,c as z}from"./array-1d6fe4d9.js";const ce=I({__name:"MiniChart",props:{class:{},values:{}},setup(B){const $=B;H([Z,x,ee]);const l=C(()=>$.class),r=C(()=>({xAxis:{type:"category",show:!1},yAxis:{show:!1,min:Math.min(...$.values)},grid:{top:"15%",left:0,bottom:"20%",right:0},series:[{data:$.values,type:"line",smooth:!0,showSymbol:!1,silent:!0}]}));return(p,m)=>(i(),P(te,{class:a(l.value),options:r.value},null,8,["class","options"]))}}),de=["type","value"],ie=I({__name:"CurrencyCell",props:{modelValue:{},max:{default:Number.MAX_SAFE_INTEGER}},emits:["update:modelValue"],setup(B,{emit:$}){const l=B,r=D(),p=D(!1),{n:m}=K(),b=C(()=>p.value||!l.modelValue?l.modelValue||"":m(l.modelValue,"currency")),V=n=>{$("update:modelValue",Math.max(n,0))},G=n=>{n.key==="-"&&n.preventDefault()},h=()=>{p.value=!0,Q(()=>{r.value.select()})},o=n=>{const t=Number(n.target.value);!Number.isNaN(t)&&V(t)};return se(()=>l.modelValue,(n,t)=>{(n??0)>l.max&&t!==void 0&&$("update:modelValue",t)}),(n,t)=>(i(),g("input",{ref_key:"input",ref:r,class:a(n.$style.currencyCell),type:p.value?"number":"text",value:b.value,onBlur:t[0]||(t[0]=v=>p.value=!1),onFocus:h,onInput:o,onKeydown:[G,t[1]||(t[1]=J((...v)=>{var A,T;return((A=r.value)==null?void 0:A.blur)&&((T=r.value)==null?void 0:T.blur(...v))},["enter"]))]},null,42,de))}}),pe="kb",me={currencyCell:pe},ve={$style:me},ye=R(ie,[["__cssModules",ve]]),c=le({source:void 0,target:void 0,type:void 0}),ge=I({__name:"Draggable",props:{text:{type:Function},id:{}},emits:["drop"],setup(B,{emit:$}){const l=B,r=D(),p=D(),m=D(0),b=D(0),V=C(()=>l.id===c.target&&c.type),G=C(()=>V.value?c.type==="before"?"skip-up-line":"skip-down-line":"draggable"),h=C(()=>{var u;return c.target&&c.target&&c.source?(u=l.text)==null?void 0:u.call(l,c):void 0}),o=u=>{u.dataTransfer&&p.value&&(c.source=l.id,u.dataTransfer.effectAllowed="move",u.dataTransfer.setDragImage(p.value,1/0,1/0))},n=u=>{m.value=u.pageX,b.value=u.pageY},t=u=>{var _;const e=(_=r.value)==null?void 0:_.getBoundingClientRect();if(u.preventDefault(),e&&l.id!==c.source){const s=u.pageY<e.top+e.height/2?"before":"after";c.target=l.id,c.type=s}},v=u=>{u.pageX&&u.pageY&&c.target!==l.id&&(c.type=void 0,c.target=void 0)},A=()=>{c.type=void 0,c.target=void 0,c.source=void 0},T=u=>{c.target&&c.target&&c.source&&$("drop",c),u.preventDefault()};return(u,e)=>(i(),g("div",{ref_key:"draggable",ref:r,class:a(u.$style.draggable),draggable:"true",onDragend:A,onDragover:t,onDragleave:v,onDrop:T,onDrag:n,onDragstart:o},[y(F,{color:V.value?"primary":"dimmed",icon:G.value,textual:""},null,8,["color","icon"]),f(c).source===l.id&&b.value&&m.value&&h.value?(i(),g("div",{key:0,style:ne({top:`${b.value+5}px`,left:`${m.value+5}px`}),class:a(u.$style.content)},[d("span",{class:a(u.$style.text)},U(h.value),3)],6)):W("",!0),d("div",{ref_key:"element",ref:p,class:a(u.$style.hidden)},"hidden",2)],34))}}),fe="lb",$e="mb",_e="nb",be="ob",he={draggable:fe,content:$e,text:_e,hidden:be},Ce={$style:he},Be=R(ge,[["__cssModules",Ce]]),ke=["value"],Me=I({__name:"TextCell",props:{modelValue:{},inline:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(B,{emit:$}){const l=B,r=D(),p=oe(),m=D(!1),b=C(()=>[p.textInput,{[p.empty]:!l.modelValue,[p.inline]:l.inline}]),V=()=>{m.value=!0,Q(()=>{r.value.select()})},G=h=>{$("update:modelValue",h.target.value)};return(h,o)=>(i(),g("span",{class:a(b.value)},[d("input",{ref_key:"input",ref:r,value:h.modelValue,class:a(h.$style.input),type:"text",onBlur:o[0]||(o[0]=n=>m.value=!1),onFocus:V,onInput:G,onKeydown:o[1]||(o[1]=J((...n)=>{var t,v;return((t=r.value)==null?void 0:t.blur)&&((v=r.value)==null?void 0:v.blur(...n))},["enter"]))},null,42,ke)],2))}}),Ve="pb",we="qb",Ge="rb",De="sb",Ne={textInput:Ve,input:we,inline:Ge,empty:De},Ie={$style:Ne},O=R(Me,[["__cssModules",Ie]]),Ae=d("span",null,null,-1),Te=d("span",{style:{"grid-column":"3 / 16"}},null,-1),Se=I({__name:"BudgetGroup",props:{group:{}},setup(B){const $=B,{moveBudget:l,getBudget:r,addBudget:p,setBudgetName:m,setBudgetGroupName:b,setBudget:V,removeBudget:G,isCurrentMonth:h}=X(),{t:o}=K(),n=D(!0),t=C(()=>{const e=new Array(12).fill(0);for(const{values:_}of $.group.budgets)for(let s=0;s<_.length;s++)e[s]+=_[s];return e}),v=C(()=>q(t.value)),A=C(()=>z(t.value)),T=e=>{const[_,s]=e.source?r(e.source)??[]:[],[k,N]=e.target?r(e.target)??[]:[];if(s&&_)if(N&&k){const M=_.id===k.id,L=M?s.name:`${_.name} » ${s.name}`,Y=M?N.name:`${k.name} » ${N.name}`;return e.type==="before"?o("budget.prepend",{from:L,to:Y}):o("budget.append",{from:L,to:Y})}else return o("budget.move",{from:s.name})},u=e=>{l(e.source,e.target,e.type==="after")};return(e,_)=>(i(),g(w,null,[y(F,{icon:n.value?"arrow-down-s-line":"arrow-right-s-line",color:"dimmed",textual:"",onClick:_[0]||(_[0]=s=>n.value=!n.value)},null,8,["icon"]),y(O,{class:a([e.$style.top,e.$style.start]),"model-value":e.group.name,inline:"","onUpdate:modelValue":_[1]||(_[1]=s=>f(b)(e.group.id,s))},null,8,["class","model-value"]),(i(!0),g(w,null,E(t.value,(s,k)=>(i(),g("span",{key:k,class:a(e.$style.top)},[y(S,{value:s},null,8,["value"])],2))),128)),d("span",{class:a(e.$style.top)},[d("span",null,U(f(o)("budget.total")),1)],2),d("span",{class:a([e.$style.top,e.$style.end])},[d("span",null,U(f(o)("budget.average")),1)],2),n.value?(i(),g(w,{key:0},[(i(!0),g(w,null,E(e.group.budgets,(s,k)=>(i(),g(w,{key:s.id+k},[y(Be,{id:s.id,text:T,onDrop:u},null,8,["id"]),y(F,{color:"dimmed",icon:"close-circle",textual:"",onClick:N=>f(G)(s.id)},null,8,["onClick"]),d("span",{class:a(e.$style.header)},[y(O,{"model-value":s.name,"onUpdate:modelValue":N=>f(m)(s.id,N)},null,8,["model-value","onUpdate:modelValue"])],2),(i(!0),g(w,null,E(s.values,(N,M)=>(i(),g("span",{key:s.id+M,class:a([e.$style.currencyCell,{[e.$style.even]:k%2,[e.$style.firstRow]:k===0,[e.$style.firstColumn]:M===0,[e.$style.currentMonth]:f(h)(M),[e.$style.tlc]:k===0&&M===0,[e.$style.trc]:k===0&&M===11,[e.$style.blc]:k===e.group.budgets.length-1&&M===0,[e.$style.brc]:k===e.group.budgets.length-1&&M===11}])},[y(ye,{"model-value":s.values[M],"onUpdate:modelValue":L=>f(V)(s.id,M,L)},null,8,["model-value","onUpdate:modelValue"])],2))),128)),y(S,{class:a(e.$style.meta),value:f(q)(s.values)},null,8,["class","value"]),y(S,{class:a(e.$style.meta),value:f(z)(s.values)},null,8,["class","value"])],64))),128)),Ae,y(F,{icon:"plus",class:a(e.$style.addBudgetBtn),textual:"",color:"success",onClick:_[2]||(_[2]=s=>f(p)(e.group.id))},null,8,["class"]),Te,y(S,{class:a([e.$style.meta,e.$style.bold]),value:v.value},null,8,["class","value"]),y(S,{class:a([e.$style.meta,e.$style.bold]),value:A.value},null,8,["class","value"])],64)):W("",!0)],64))}}),Ee="J_",Fe="K_",Re="L_",Ue="M_",Le="N_",Pe="O_",Ke="P_",Xe="Q_",Ye="R_",je="S_",qe="T_",ze="U_",Oe="V_",Je="W_",Qe="X_",We={header:Ee,meta:Fe,bold:Re,top:Ue,start:Le,end:Pe,currencyCell:Ke,firstRow:Xe,firstColumn:Ye,currentMonth:je,even:qe,tlc:ze,trc:Oe,blc:Je,brc:Qe},He={$style:We},Ze=R(Se,[["__cssModules",He]]),xe=d("span",null,null,-1),et=d("span",null,null,-1),tt=d("span",null,null,-1),st=d("span",null,null,-1),lt=d("span",null,null,-1),nt=d("span",null,null,-1),ot=d("span",null,null,-1),at=d("span",null,null,-1),ut=d("span",null,null,-1),rt=d("span",null,null,-1),ct=I({__name:"BudgetGroups",props:{type:{}},setup(B){const $=B,{state:l,addBudgetGroup:r,removeBudgetGroup:p,isCurrentMonth:m}=X(),{t:b}=K(),V=C(()=>l[$.type]),G=re(),h=C(()=>{const o=new Array(12).fill(0);for(const{budgets:n}of V.value)for(const{values:t}of n)for(let v=0;v<t.length;v++)o[v]+=t[v];return o});return(o,n)=>(i(),g("div",{class:a(o.$style.budgetGroups)},[xe,et,tt,(i(!0),g(w,null,E(f(G),(t,v)=>(i(),g("span",{key:t,class:a([o.$style.month,{[o.$style.current]:f(m)(v)}])},[d("span",null,U(t),1)],2))),128)),st,lt,nt,ot,d("span",{class:a(o.$style.sum)},U(f(b)("budget.totals")),3),(i(!0),g(w,null,E(h.value,(t,v)=>(i(),P(S,{key:v,value:t,class:a(o.$style.sum)},null,8,["value","class"]))),128)),at,ut,(i(!0),g(w,null,E(V.value,t=>(i(),g(w,{key:t.id},[y(F,{color:"dimmed",icon:"close-circle",textual:"",onClick:v=>f(p)(t.id)},null,8,["onClick"]),y(Ze,{group:t},null,8,["group"])],64))),128)),rt,y(F,{class:a(o.$style.addGroupBtn),icon:"plus",text:f(b)("budget.addGroup"),onClick:n[0]||(n[0]=t=>f(r)(o.type))},null,8,["class","text"])],2))}}),dt="f_",it="g_",pt="h_",mt="i_",vt="j_",yt={budgetGroups:dt,sum:it,month:pt,current:mt,addGroupBtn:vt},gt={$style:yt},ft=R(ct,[["__cssModules",gt]]),$t=I({__name:"BudgetPane",props:{title:{},type:{}},setup(B){const $=B,{state:l}=X(),r=C(()=>ae(l[$.type])),p=C(()=>r.value.reduce((m,b)=>m+b,0));return(m,b)=>(i(),P(ue,{amount:p.value,title:m.title},{header:j(()=>[y(ce,{class:a(m.$style.miniChart),values:r.value},null,8,["class","values"])]),default:j(()=>[y(ft,{type:m.type},null,8,["type"])]),_:1},8,["amount","title"]))}}),_t="t",bt={miniChart:_t},ht={$style:bt},Nt=R($t,[["__cssModules",ht]]);export{Nt as B};
