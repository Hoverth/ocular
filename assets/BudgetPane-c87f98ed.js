import{u as H,i as J,a as x,b as ee,_ as te}from"./EChart.vue_vue_type_script_setup_true_lang-8bc55790.js";import{d as T,c as C,o as g,i as U,n as a,K as se,x as A,a as $,l as y,k as v,s as le,b as c,t as P,p as ne,_ as E,e as K,L as oe,M as Q,N as W,y as ae,f as X,F as N,r as S,B as z,G as O,w as j}from"./index-5f56ba51.js";import{t as ue}from"./budgets-531db56b.js";import{P as re}from"./Pane-692764bc.js";import{B as L}from"./Button-f866867e.js";import{C as F}from"./Currency-44ef8ee1.js";import{u as ce}from"./useMonthNames-bd9ea0ad.js";const de=T({__name:"MiniChart",props:{class:{},values:{}},setup(k){const b=k;H([J,x,ee]);const s=C(()=>b.class),d=C(()=>({xAxis:{type:"category",show:!1},yAxis:{show:!1,min:Math.min(...b.values)},grid:{top:"15%",left:0,bottom:"20%",right:0},series:[{data:b.values,type:"line",smooth:!0,showSymbol:!1,silent:!0}]}));return(i,m)=>(g(),U(te,{class:a(s.value),options:d.value},null,8,["class","options"]))}}),o=se({group:void 0,source:void 0,target:void 0,type:void 0}),pe=T({__name:"Draggable",props:{text:{type:Function},name:{},id:{}},emits:["drop"],setup(k,{emit:b}){const s=k,d=A(),i=A(),m=A(0),h=A(0),M=C(()=>s.id===o.target&&o.type),w=C(()=>M.value?o.type==="before"?"skip-up-line":"skip-down-line":"draggable"),B=C(()=>{var t;return o.target&&o.target&&o.source?(t=s.text)==null?void 0:t.call(s,o):void 0}),V=t=>{t.dataTransfer&&i.value&&(o.group=s.name,o.source=s.id,t.dataTransfer.effectAllowed="move",t.dataTransfer.setDragImage(i.value,1/0,1/0),t.dataTransfer.setData("text/plain",s.name))},u=t=>{m.value=t.pageX,h.value=t.pageY},p=t=>{var e;if(o.group===s.name){const f=(e=d.value)==null?void 0:e.getBoundingClientRect();if(t.preventDefault(),f&&s.id!==o.source){const n=t.pageY<f.top+f.height/2?"before":"after";o.target=s.id,o.type=n}}},l=t=>{t.pageX&&t.pageY&&o.target!==s.id&&(o.type=void 0,o.target=void 0)},_=()=>{o.type=void 0,o.target=void 0,o.source=void 0,o.group=void 0},r=t=>{o.target&&o.target&&o.source&&b("drop",o),t.preventDefault()};return(t,e)=>(g(),$("div",{ref_key:"draggable",ref:d,class:a(t.$style.draggable),draggable:"true",onDragend:_,onDragover:p,onDragleave:l,onDrop:r,onDrag:u,onDragstart:V},[y(L,{color:v(o).group===s.name?"primary":"dimmed",icon:w.value,textual:""},null,8,["color","icon"]),v(o).source===s.id&&h.value&&m.value&&B.value?(g(),$("div",{key:0,style:le({top:`${h.value+5}px`,left:`${m.value+5}px`}),class:a(t.$style.content)},[c("span",{class:a(t.$style.text)},P(B.value),3)],6)):ne("",!0),c("div",{ref_key:"element",ref:i,class:a(t.$style.hidden)},"hidden",2)],34))}}),ie="N_",me="O_",ge="P_",ye="Q_",ve={draggable:ie,content:me,text:ge,hidden:ye},fe={$style:ve},Z=E(pe,[["__cssModules",fe]]),$e=["type","value"],be=T({__name:"CurrencyCell",props:{modelValue:{},max:{default:Number.MAX_SAFE_INTEGER}},emits:["update:modelValue"],setup(k,{emit:b}){const s=k,d=A(),i=A(!1),{n:m}=K(),h=C(()=>i.value||!s.modelValue?s.modelValue||"":m(s.modelValue,"currency")),M=u=>{b("update:modelValue",Math.max(u,0))},w=u=>{u.key==="-"&&u.preventDefault()},B=()=>{i.value=!0,W(()=>{d.value.select()})},V=u=>{const p=Number(u.target.value);!Number.isNaN(p)&&M(p)};return oe(()=>s.modelValue,(u,p)=>{(u??0)>s.max&&p!==void 0&&b("update:modelValue",p)}),(u,p)=>(g(),$("input",{ref_key:"input",ref:d,class:a(u.$style.currencyCell),type:i.value?"number":"text",value:h.value,onBlur:p[0]||(p[0]=l=>i.value=!1),onFocus:B,onInput:V,onKeydown:[w,p[1]||(p[1]=Q((...l)=>{var _,r;return((_=d.value)==null?void 0:_.blur)&&((r=d.value)==null?void 0:r.blur(...l))},["enter"]))]},null,42,$e))}}),_e="sb",he={currencyCell:_e},Be={$style:he},Ce=E(be,[["__cssModules",Be]]),ke=["value"],Me=T({__name:"TextCell",props:{modelValue:{},inline:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(k,{emit:b}){const s=k,d=A(),i=ae(),m=A(!1),h=C(()=>[i.textInput,{[i.empty]:!s.modelValue,[i.inline]:s.inline}]),M=()=>{m.value=!0,W(()=>{d.value.select()})},w=B=>{b("update:modelValue",B.target.value)};return(B,V)=>(g(),$("span",{class:a(h.value)},[c("input",{ref_key:"input",ref:d,value:B.modelValue,class:a(B.$style.input),type:"text",onBlur:V[0]||(V[0]=u=>m.value=!1),onFocus:M,onInput:w,onKeydown:V[1]||(V[1]=Q((...u)=>{var p,l;return((p=d.value)==null?void 0:p.blur)&&((l=d.value)==null?void 0:l.blur(...u))},["enter"]))},null,42,ke)],2))}}),Ge="yb",Ve="zb",De="Ab",we="Bb",Ne={textInput:Ge,input:Ve,inline:De,empty:we},Ae={$style:Ne},q=E(Me,[["__cssModules",Ae]]),Ie=c("span",null,null,-1),Te=c("span",{style:{"grid-column":"3 / 16"}},null,-1),Fe=T({__name:"BudgetGroup",props:{group:{}},setup(k){const b=k,{moveBudget:s,removeBudgetGroup:d,getBudget:i,addBudget:m,setBudgetName:h,setBudgetGroupName:M,setBudget:w,removeBudget:B,isCurrentMonth:V}=X(),{t:u}=K(),p=C(()=>{const e=new Array(12).fill(0);for(const{values:f}of b.group.budgets)for(let n=0;n<f.length;n++)e[n]+=f[n];return e}),l=C(()=>z(p.value)),_=C(()=>O(p.value)),r=e=>{const[f,n]=e.source?i(e.source)??[]:[],[G,I]=e.target?i(e.target)??[]:[];if(n&&f){if(I&&G){const D=f.id===G.id,R=D?n.name:`${f.name} » ${n.name}`,Y=D?I.name:`${G.name} » ${I.name}`;return e.type==="before"?u("budget.prepend",{from:R,to:Y}):u("budget.append",{from:R,to:Y})}return u("budget.move",{from:n.name})}},t=e=>{s(e.source,e.target,e.type==="after")};return(e,f)=>(g(),$(N,null,[y(L,{color:"dimmed",icon:"close-circle",textual:"",onClick:f[0]||(f[0]=n=>v(d)(e.group.id))}),y(q,{class:a([e.$style.top,e.$style.start]),"model-value":e.group.name,inline:"","onUpdate:modelValue":f[1]||(f[1]=n=>v(M)(e.group.id,n))},null,8,["class","model-value"]),(g(!0),$(N,null,S(p.value,(n,G)=>(g(),$("span",{key:G,class:a(e.$style.top)},[y(F,{value:n},null,8,["value"])],2))),128)),c("span",{class:a(e.$style.top)},[c("span",null,P(v(u)("budget.total")),1)],2),c("span",{class:a([e.$style.top,e.$style.end])},[c("span",null,P(v(u)("budget.average")),1)],2),(g(!0),$(N,null,S(e.group.budgets,(n,G)=>(g(),$(N,{key:n.id+G},[y(Z,{id:n.id,name:"budget-group",text:r,onDrop:t},null,8,["id"]),y(L,{color:"dimmed",icon:"close-circle",textual:"",onClick:I=>v(B)(n.id)},null,8,["onClick"]),c("span",{class:a(e.$style.header)},[y(q,{"model-value":n.name,"onUpdate:modelValue":I=>v(h)(n.id,I)},null,8,["model-value","onUpdate:modelValue"])],2),(g(!0),$(N,null,S(n.values,(I,D)=>(g(),$("span",{key:n.id+D,class:a([e.$style.currencyCell,{[e.$style.even]:G%2,[e.$style.firstRow]:G===0,[e.$style.firstColumn]:D===0,[e.$style.currentMonth]:v(V)(D),[e.$style.tlc]:G===0&&D===0,[e.$style.trc]:G===0&&D===11,[e.$style.blc]:G===e.group.budgets.length-1&&D===0,[e.$style.brc]:G===e.group.budgets.length-1&&D===11}])},[y(Ce,{"model-value":n.values[D],"onUpdate:modelValue":R=>v(w)(n.id,D,R)},null,8,["model-value","onUpdate:modelValue"])],2))),128)),y(F,{class:a(e.$style.meta),value:v(z)(n.values)},null,8,["class","value"]),y(F,{class:a(e.$style.meta),value:v(O)(n.values)},null,8,["class","value"])],64))),128)),Ie,y(L,{icon:"plus",class:a(e.$style.addBudgetBtn),textual:"",color:"success",onClick:f[2]||(f[2]=n=>v(m)(e.group.id))},null,8,["class"]),Te,y(F,{class:a([e.$style.meta,e.$style.bold]),value:l.value},null,8,["class","value"]),y(F,{class:a([e.$style.meta,e.$style.bold]),value:_.value},null,8,["class","value"])],64))}}),Se="W_",Ee="X_",Le="Y_",Pe="Z_",Re="_b",Ue="ab",Ke="bb",Xe="cb",Ye="db",ze="eb",Oe="fb",je="gb",qe="hb",Qe="ib",We="jb",Ze={header:Se,meta:Ee,bold:Le,top:Pe,start:Re,end:Ue,currencyCell:Ke,firstRow:Xe,firstColumn:Ye,currentMonth:ze,even:Oe,tlc:je,trc:qe,blc:Qe,brc:We},He={$style:Ze},Je=E(Fe,[["__cssModules",He]]),xe=c("span",null,null,-1),et=c("span",null,null,-1),tt=c("span",null,null,-1),st=c("span",null,null,-1),lt=c("span",null,null,-1),nt=c("span",null,null,-1),ot=c("span",null,null,-1),at=c("span",null,null,-1),ut=c("span",null,null,-1),rt=c("span",null,null,-1),ct=T({__name:"BudgetGroups",props:{type:{}},setup(k){const b=k,{state:s,moveBudgetGroup:d,addBudgetGroup:i,getBudgetGroup:m,isCurrentMonth:h}=X(),{t:M}=K(),w=C(()=>s[b.type]),B=ce(),V=C(()=>{const l=new Array(12).fill(0);for(const{budgets:_}of w.value)for(const{values:r}of _)for(let t=0;t<r.length;t++)l[t]+=r[t];return l}),u=l=>{const _=l.source?m(l.source):void 0,r=l.target?m(l.target):void 0;if(_)return r?l.type==="before"?M("budget.prepend",{from:_.name,to:r.name}):M("budget.append",{from:_.name,to:r.name}):M("budget.move",{from:_.name})},p=l=>{d(l.source,l.target,l.type==="after")};return(l,_)=>(g(),$("div",{class:a(l.$style.budgetGroups)},[xe,et,tt,(g(!0),$(N,null,S(v(B),(r,t)=>(g(),$("span",{key:r,class:a([l.$style.month,{[l.$style.current]:v(h)(t)}])},[c("span",null,P(r),1)],2))),128)),st,lt,nt,ot,c("span",{class:a(l.$style.sum)},P(v(M)("budget.totals")),3),(g(!0),$(N,null,S(V.value,(r,t)=>(g(),U(F,{key:t,value:r,class:a(l.$style.sum)},null,8,["value","class"]))),128)),at,ut,(g(!0),$(N,null,S(w.value,r=>(g(),$(N,{key:r.id},[y(Z,{id:r.id,text:u,name:"budget-groups",onDrop:p},null,8,["id"]),y(Je,{group:r},null,8,["group"])],64))),128)),rt,y(L,{class:a(l.$style.addGroupBtn),icon:"plus",text:v(M)("budget.addGroup"),onClick:_[0]||(_[0]=r=>v(i)(l.type))},null,8,["class","text"])],2))}}),dt="n_",pt="o_",it="p_",mt="q_",gt="r_",yt={budgetGroups:dt,sum:pt,month:it,current:mt,addGroupBtn:gt},vt={$style:yt},ft=E(ct,[["__cssModules",vt]]),$t=T({__name:"BudgetPane",props:{title:{},type:{}},setup(k){const b=k,{state:s}=X(),d=C(()=>ue(s[b.type])),i=C(()=>d.value.reduce((m,h)=>m+h,0));return(m,h)=>(g(),U(re,{amount:i.value,title:m.title},{header:j(()=>[y(de,{class:a(m.$style.miniChart),values:d.value},null,8,["class","values"])]),default:j(()=>[y(ft,{type:m.type},null,8,["type"])]),_:1},8,["amount","title"]))}}),bt="b",_t={miniChart:bt},ht={$style:_t},wt=E($t,[["__cssModules",ht]]);export{wt as B};
